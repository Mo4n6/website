
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Every year around the holidays SAN releases their CTF Holiday Hack challenge. These Holiday Hack challenges consists of a story and a mystery that revolve around the holidays and Santa. This write-up will provide a walkthrough of the Holiday Hack Challenge. It includes a walkthrough of each objectives and terminal challenge. It will also provide inspiring quotes, hints and strategies on solving future challenges.">
      
      
      
      <link rel="icon" href="../../../../images/terminal-24.svg">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Kringlecon 2 - 2019 SANS Hack Holiday Challenge Write-up - Mo Sharif</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#e92063">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.3b61ea93.min.css">
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/palette.39b8e14a.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="pink" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Mo Sharif" class="md-header__button md-logo" aria-label="Mo Sharif" data-md-component="logo">
      
  <img src="../../../../images/terminal-24.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mo Sharif
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kringlecon 2 - 2019 SANS Hack Holiday Challenge Write-up
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Mo Sharif" class="md-nav__button md-logo" aria-label="Mo Sharif" data-md-component="logo">
      
  <img src="../../../../images/terminal-24.svg" alt="logo">

    </a>
    Mo Sharif
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Posts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Posts" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Posts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          2022
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2022" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          2022
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2022/kringlecon4/" class="md-nav__link">
        KringleCon 4
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          2021
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2021" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          2021
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2021/kringlecon3/" class="md-nav__link">
        KringleCon 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2021/post1/" class="md-nav__link">
        Migrating Blog from Jekyll to MkDocs on GitHub pages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          2020
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2020" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          2020
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          KringleCon 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        KringleCon 2
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protips" class="md-nav__link">
    Protips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-challenge-logo" class="md-nav__link">
    Holiday Hack Challenge Logo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-0-talk-to-santa-in-the-quad" class="md-nav__link">
    Objective 0 - Talk to Santa in the Quad
  </a>
  
    <nav class="md-nav" aria-label="Objective 0 - Talk to Santa in the Quad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-0-walkthrough" class="md-nav__link">
    Objective 0 - Walkthrough
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-0-solution" class="md-nav__link">
    Objective 0 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-1-find-the-turtle-doves" class="md-nav__link">
    Objective 1 - Find the Turtle Doves
  </a>
  
    <nav class="md-nav" aria-label="Objective 1 - Find the Turtle Doves">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-1-walkthrough" class="md-nav__link">
    Objective 1 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 1 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-1-solution" class="md-nav__link">
    Objective 1 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-2-unredact-threatening-document" class="md-nav__link">
    Objective 2 - Unredact Threatening Document
  </a>
  
    <nav class="md-nav" aria-label="Objective 2 - Unredact Threatening Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2-walkthrough" class="md-nav__link">
    Objective 2 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 2 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2-solution" class="md-nav__link">
    Objective 2 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-3-windows-log-analysis-evaluate-attack-outcome" class="md-nav__link">
    Objective 3 - Windows Log Analysis: Evaluate Attack Outcome
  </a>
  
    <nav class="md-nav" aria-label="Objective 3 - Windows Log Analysis: Evaluate Attack Outcome">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#escape-ed-terminal-challenge" class="md-nav__link">
    Escape Ed - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Escape Ed - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#escape-ed-solution" class="md-nav__link">
    Escape Ed - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-3-walkthrough" class="md-nav__link">
    Objective 3 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 3 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-3-solution" class="md-nav__link">
    Objective 3 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-4-windows-log-analysis-determine-attacker-technique" class="md-nav__link">
    Objective 4 - Windows Log Analysis: Determine Attacker Technique
  </a>
  
    <nav class="md-nav" aria-label="Objective 4 - Windows Log Analysis: Determine Attacker Technique">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-path-terminal-challenge" class="md-nav__link">
    Linux Path - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Linux Path - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-path-solution" class="md-nav__link">
    Linux Path - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-4-walkthrough" class="md-nav__link">
    Objective 4 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 4 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-4-solution" class="md-nav__link">
    Objective 4 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-5-network-log-analysis-determine-compromised-system" class="md-nav__link">
    Objective 5 - Network Log Analysis: Determine Compromised System
  </a>
  
    <nav class="md-nav" aria-label="Objective 5 - Network Log Analysis: Determine Compromised System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xmas-cheer-laser-terminal-challenge" class="md-nav__link">
    Xmas Cheer Laser - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Xmas Cheer Laser - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xmas-cheer-laser-solution" class="md-nav__link">
    Xmas Cheer Laser - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-5-walkthrough" class="md-nav__link">
    Objective 5 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 5 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-5-solution" class="md-nav__link">
    Objective 5 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-6-splunk" class="md-nav__link">
    Objective 6 - Splunk
  </a>
  
    <nav class="md-nav" aria-label="Objective 6 - Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splunk-training-questions-terminal-challenge" class="md-nav__link">
    Splunk Training Questions - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Splunk Training Questions - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splunk-training-questions-solution" class="md-nav__link">
    Splunk Training Questions - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-6-walkthrough" class="md-nav__link">
    Objective 6 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 6 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-6-solution" class="md-nav__link">
    Objective 6 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-7-get-access-to-the-steam-tunnels" class="md-nav__link">
    Objective 7 - Get Access To The Steam Tunnels
  </a>
  
    <nav class="md-nav" aria-label="Objective 7 - Get Access To The Steam Tunnels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frosty-keypad-challenge" class="md-nav__link">
    Frosty Keypad Challenge
  </a>
  
    <nav class="md-nav" aria-label="Frosty Keypad Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frosty-keypad-solution" class="md-nav__link">
    Frosty Keypad - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-trial-terminal-challenge" class="md-nav__link">
    Holiday Hack Trial - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Holiday Hack Trial - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-mode" class="md-nav__link">
    Easy mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medium-mode" class="md-nav__link">
    Medium mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-mode" class="md-nav__link">
    Hard mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-trial-solution" class="md-nav__link">
    Holiday Hack Trial - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-7-walkthrough" class="md-nav__link">
    Objective 7 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 7 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-7-solution" class="md-nav__link">
    Objective 7 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-8-bypassing-the-frido-sleigh-capteha" class="md-nav__link">
    Objective 8 - Bypassing the Frido Sleigh CAPTEHA
  </a>
  
    <nav class="md-nav" aria-label="Objective 8 - Bypassing the Frido Sleigh CAPTEHA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nyanshell-terminal-challenge" class="md-nav__link">
    Nyanshell - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Nyanshell - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nyanshell-solution" class="md-nav__link">
    Nyanshell - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-8-walkthrough" class="md-nav__link">
    Objective 8 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 8 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-8-solution" class="md-nav__link">
    Objective 8 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-9-retrieve-scraps-of-paper-from-server" class="md-nav__link">
    Objective 9 - Retrieve Scraps of Paper from Server
  </a>
  
    <nav class="md-nav" aria-label="Objective 9 - Retrieve Scraps of Paper from Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graylog-terminal-challenge" class="md-nav__link">
    Graylog - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Graylog - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graylog-solution" class="md-nav__link">
    Graylog - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-9-walkthrough" class="md-nav__link">
    Objective 9 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 9 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-9-solution" class="md-nav__link">
    Objective 9 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-10-recover-cleartext-document" class="md-nav__link">
    Objective 10 - Recover Cleartext Document
  </a>
  
    <nav class="md-nav" aria-label="Objective 10 - Recover Cleartext Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongo-pilfer-terminal-challenge" class="md-nav__link">
    Mongo Pilfer - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Mongo Pilfer - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongo-pilfer-solution" class="md-nav__link">
    Mongo Pilfer - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-10-walkthrough" class="md-nav__link">
    Objective 10 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 10 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-10-solution" class="md-nav__link">
    Objective 10 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-11-open-the-sleigh-shop-door" class="md-nav__link">
    Objective 11 - Open the Sleigh Shop Door
  </a>
  
    <nav class="md-nav" aria-label="Objective 11 - Open the Sleigh Shop Door">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smart-braces-terminal-challenge" class="md-nav__link">
    Smart Braces - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Smart Braces - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smart-braces-solution" class="md-nav__link">
    Smart Braces - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-11-walkthrough" class="md-nav__link">
    Objective 11 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 11 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lock-1" class="md-nav__link">
    Lock 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-2" class="md-nav__link">
    Lock 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-3" class="md-nav__link">
    Lock 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-4" class="md-nav__link">
    Lock 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-5" class="md-nav__link">
    Lock 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-6" class="md-nav__link">
    Lock 6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-7" class="md-nav__link">
    Lock 7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-8" class="md-nav__link">
    Lock 8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-9" class="md-nav__link">
    Lock 9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-10" class="md-nav__link">
    Lock 10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-11-solution" class="md-nav__link">
    Objective 11 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-12-filter-out-poisoned-sources-of-weather-data" class="md-nav__link">
    Objective 12 - Filter Out Poisoned Sources of Weather Data
  </a>
  
    <nav class="md-nav" aria-label="Objective 12 - Filter Out Poisoned Sources of Weather Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zeek-json-analysis-terminal-challenge" class="md-nav__link">
    Zeek JSON Analysis - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Zeek JSON Analysis - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zeek-json-analysis-solution" class="md-nav__link">
    Zeek JSON Analysis - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-12-walkthrough" class="md-nav__link">
    Objective 12 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 12 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-12-solution" class="md-nav__link">
    Objective 12 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          2019
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2019" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          2019
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2019/post3/2019-06-16-HowToDeobfuscateJS/" class="md-nav__link">
        How to Deobfuscate JavaScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2019/post2/2019-04-22-HowToSignUpForHackTheBox/" class="md-nav__link">
        How to Sign Up for Hack The Box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2019/post1/2019-04-06-HowToCreateAVM/" class="md-nav__link">
        How to Create a Win10 VM for Malware Analysis, Forensic or Offensive Tasks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          2018
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2018" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          2018
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2018/post3/2018-12-16-HowToCreateAnAWSLambdaLayer/" class="md-nav__link">
        How to Create an AWS Lambda Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2018/post2/2018-11-12-HowToCreateAnAWSLambdaFunction/" class="md-nav__link">
        How to Create an AWS Lambda Function
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2018/post1/2018-11-03-HowToCreateATwitterApp/" class="md-nav__link">
        How to Create a Twitter App
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/" class="md-nav__link">
        Books
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../podcasts/" class="md-nav__link">
        Podcasts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.patreon.com/mo4n6" class="md-nav__link">
        Donate
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protips" class="md-nav__link">
    Protips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-challenge-logo" class="md-nav__link">
    Holiday Hack Challenge Logo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-0-talk-to-santa-in-the-quad" class="md-nav__link">
    Objective 0 - Talk to Santa in the Quad
  </a>
  
    <nav class="md-nav" aria-label="Objective 0 - Talk to Santa in the Quad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-0-walkthrough" class="md-nav__link">
    Objective 0 - Walkthrough
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-0-solution" class="md-nav__link">
    Objective 0 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-1-find-the-turtle-doves" class="md-nav__link">
    Objective 1 - Find the Turtle Doves
  </a>
  
    <nav class="md-nav" aria-label="Objective 1 - Find the Turtle Doves">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-1-walkthrough" class="md-nav__link">
    Objective 1 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 1 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-1-solution" class="md-nav__link">
    Objective 1 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-2-unredact-threatening-document" class="md-nav__link">
    Objective 2 - Unredact Threatening Document
  </a>
  
    <nav class="md-nav" aria-label="Objective 2 - Unredact Threatening Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2-walkthrough" class="md-nav__link">
    Objective 2 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 2 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2-solution" class="md-nav__link">
    Objective 2 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-3-windows-log-analysis-evaluate-attack-outcome" class="md-nav__link">
    Objective 3 - Windows Log Analysis: Evaluate Attack Outcome
  </a>
  
    <nav class="md-nav" aria-label="Objective 3 - Windows Log Analysis: Evaluate Attack Outcome">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#escape-ed-terminal-challenge" class="md-nav__link">
    Escape Ed - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Escape Ed - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#escape-ed-solution" class="md-nav__link">
    Escape Ed - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-3-walkthrough" class="md-nav__link">
    Objective 3 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 3 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-3-solution" class="md-nav__link">
    Objective 3 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-4-windows-log-analysis-determine-attacker-technique" class="md-nav__link">
    Objective 4 - Windows Log Analysis: Determine Attacker Technique
  </a>
  
    <nav class="md-nav" aria-label="Objective 4 - Windows Log Analysis: Determine Attacker Technique">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-path-terminal-challenge" class="md-nav__link">
    Linux Path - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Linux Path - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-path-solution" class="md-nav__link">
    Linux Path - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-4-walkthrough" class="md-nav__link">
    Objective 4 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 4 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-4-solution" class="md-nav__link">
    Objective 4 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-5-network-log-analysis-determine-compromised-system" class="md-nav__link">
    Objective 5 - Network Log Analysis: Determine Compromised System
  </a>
  
    <nav class="md-nav" aria-label="Objective 5 - Network Log Analysis: Determine Compromised System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xmas-cheer-laser-terminal-challenge" class="md-nav__link">
    Xmas Cheer Laser - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Xmas Cheer Laser - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xmas-cheer-laser-solution" class="md-nav__link">
    Xmas Cheer Laser - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-5-walkthrough" class="md-nav__link">
    Objective 5 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 5 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-5-solution" class="md-nav__link">
    Objective 5 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-6-splunk" class="md-nav__link">
    Objective 6 - Splunk
  </a>
  
    <nav class="md-nav" aria-label="Objective 6 - Splunk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splunk-training-questions-terminal-challenge" class="md-nav__link">
    Splunk Training Questions - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Splunk Training Questions - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splunk-training-questions-solution" class="md-nav__link">
    Splunk Training Questions - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-6-walkthrough" class="md-nav__link">
    Objective 6 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 6 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-6-solution" class="md-nav__link">
    Objective 6 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-7-get-access-to-the-steam-tunnels" class="md-nav__link">
    Objective 7 - Get Access To The Steam Tunnels
  </a>
  
    <nav class="md-nav" aria-label="Objective 7 - Get Access To The Steam Tunnels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frosty-keypad-challenge" class="md-nav__link">
    Frosty Keypad Challenge
  </a>
  
    <nav class="md-nav" aria-label="Frosty Keypad Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frosty-keypad-solution" class="md-nav__link">
    Frosty Keypad - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-trial-terminal-challenge" class="md-nav__link">
    Holiday Hack Trial - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Holiday Hack Trial - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-mode" class="md-nav__link">
    Easy mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medium-mode" class="md-nav__link">
    Medium mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-mode" class="md-nav__link">
    Hard mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#holiday-hack-trial-solution" class="md-nav__link">
    Holiday Hack Trial - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-7-walkthrough" class="md-nav__link">
    Objective 7 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 7 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-7-solution" class="md-nav__link">
    Objective 7 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-8-bypassing-the-frido-sleigh-capteha" class="md-nav__link">
    Objective 8 - Bypassing the Frido Sleigh CAPTEHA
  </a>
  
    <nav class="md-nav" aria-label="Objective 8 - Bypassing the Frido Sleigh CAPTEHA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nyanshell-terminal-challenge" class="md-nav__link">
    Nyanshell - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Nyanshell - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nyanshell-solution" class="md-nav__link">
    Nyanshell - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-8-walkthrough" class="md-nav__link">
    Objective 8 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 8 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-8-solution" class="md-nav__link">
    Objective 8 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-9-retrieve-scraps-of-paper-from-server" class="md-nav__link">
    Objective 9 - Retrieve Scraps of Paper from Server
  </a>
  
    <nav class="md-nav" aria-label="Objective 9 - Retrieve Scraps of Paper from Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graylog-terminal-challenge" class="md-nav__link">
    Graylog - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Graylog - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graylog-solution" class="md-nav__link">
    Graylog - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-9-walkthrough" class="md-nav__link">
    Objective 9 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 9 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-9-solution" class="md-nav__link">
    Objective 9 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-10-recover-cleartext-document" class="md-nav__link">
    Objective 10 - Recover Cleartext Document
  </a>
  
    <nav class="md-nav" aria-label="Objective 10 - Recover Cleartext Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongo-pilfer-terminal-challenge" class="md-nav__link">
    Mongo Pilfer - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Mongo Pilfer - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongo-pilfer-solution" class="md-nav__link">
    Mongo Pilfer - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-10-walkthrough" class="md-nav__link">
    Objective 10 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 10 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-10-solution" class="md-nav__link">
    Objective 10 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-11-open-the-sleigh-shop-door" class="md-nav__link">
    Objective 11 - Open the Sleigh Shop Door
  </a>
  
    <nav class="md-nav" aria-label="Objective 11 - Open the Sleigh Shop Door">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smart-braces-terminal-challenge" class="md-nav__link">
    Smart Braces - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Smart Braces - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smart-braces-solution" class="md-nav__link">
    Smart Braces - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-11-walkthrough" class="md-nav__link">
    Objective 11 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 11 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lock-1" class="md-nav__link">
    Lock 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-2" class="md-nav__link">
    Lock 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-3" class="md-nav__link">
    Lock 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-4" class="md-nav__link">
    Lock 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-5" class="md-nav__link">
    Lock 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-6" class="md-nav__link">
    Lock 6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-7" class="md-nav__link">
    Lock 7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-8" class="md-nav__link">
    Lock 8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-9" class="md-nav__link">
    Lock 9
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lock-10" class="md-nav__link">
    Lock 10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-11-solution" class="md-nav__link">
    Objective 11 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-12-filter-out-poisoned-sources-of-weather-data" class="md-nav__link">
    Objective 12 - Filter Out Poisoned Sources of Weather Data
  </a>
  
    <nav class="md-nav" aria-label="Objective 12 - Filter Out Poisoned Sources of Weather Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zeek-json-analysis-terminal-challenge" class="md-nav__link">
    Zeek JSON Analysis - Terminal Challenge
  </a>
  
    <nav class="md-nav" aria-label="Zeek JSON Analysis - Terminal Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zeek-json-analysis-solution" class="md-nav__link">
    Zeek JSON Analysis - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-12-walkthrough" class="md-nav__link">
    Objective 12 - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Objective 12 - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-12-solution" class="md-nav__link">
    Objective 12 - Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>KringleCon 2</h1>

<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image01.PNG" alt="">
    <br>
    Kringlecon 2 - Holiday Hack Challenge 2019
</div>
<p><br></p>
<p><a href="https://holidayhackchallenge.com/2018/story.html">Kringlecon 2 - Holiday Hack Challenge 2019</a></p>
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Every year around the holidays SAN releases their CTF Holiday Hack challenge. These Holiday Hack challenges consists of a story and a mystery that revolve around the holidays and Santa.</p>
<p>As a player, you get to interact with a 2D world and work on solving challenges. Solving these challenges help players unravel the mystery of the holidays. As a result the players are put in a though spot to help Santa and save christmas.</p>
<p>This year's challenge is located at Elf university. There are 12 main objectives to solve in this year's challenge. The objectives have varying  difficulty level, from 1 to 5 (easiest to hardest).</p>
<p>The players can receive hints for the main objectives by solving mini challenges called terminal challenges. As players solve each objective and terminal challenge, they receive badges.</p>
<p>As part of the holiday hack challenge, SANs releases a number of educational videos that may be helpful for solving the objectives.</p>
<p>This write-up will provide a walkthrough of the Holiday Hack Challenge. It includes a walkthrough of each objectives and terminal challenge. It will also provide inspiring quotes, hints and strategies on solving future challenges.</p>
<p>Links:</p>
<ul>
<li><a href="https://holidayhackchallenge.com/2019/">Holiday Hack Challenge 2019</a></li>
<li><a href="https://holidayhackchallenge.com/2019/music.html">Free Album</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">KringleCon 2019 Videos</a></li>
</ul>
<p><br></p>
<h3 id="protips">Protips<a class="headerlink" href="#protips" title="Permanent link">&para;</a></h3>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image02.PNG" alt="">
    <br>
    Kringlecon 2 - What You Can Do
</div>
<p><br>  </p>
<hr />
<p>My strategy for tackling each objective is as follow:
- Solve the Terminal Challenges
- Watch all the Videos
- Tackle the Objective
- Document and take screenshots as progressing through the game.</p>
<hr />
<p>A tip from John Hammond to hold predominance over the universe:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image09.PNG" alt="">
    <br>
    Kringlecon 2 - The Infinity <strike>Stone</strike> Step
</div>
<p><br><br />
The Pwn step is a function for the domain that you're trying to achieve predominance. It's a multidimensional thing.</p>
<hr />
<p>There is a good series of tips by Katie Knowles in this conference. They can be watched <a href="https://www.youtube.com/watch?v=c02mH7F1xvU">here</a>.
Here is some keypoints of this talk:</p>
<blockquote>
<p>Know your what and how!</p>
</blockquote>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image239-2.PNG"
     alt="">
    <br>
    Kringlecon 2 - How to Hack
</div>
<p><br>  </p>
<blockquote>
<p>How to Hack!</p>
</blockquote>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image240.PNG"
     alt="">
    <br>
    Kringlecon 2 - How to Hack
</div>
<p><br>  </p>
<blockquote>
<p>The problem spiral, which in some ways is the pwn step of the infinity <strike> stone </strike> step:</p>
</blockquote>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image241.PNG"
     alt="">
    <br>
    Kringlecon 2 - How to Hack!
</div>
<p><br>  </p>
<blockquote>
<p>Read this book!</p>
</blockquote>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image242.PNG"
     alt="">
    <br>
    Kringlecon 2 - Read this book before bed.
</div>
<p><br>  </p>
<hr />
<h3 id="holiday-hack-challenge-logo">Holiday Hack Challenge Logo<a class="headerlink" href="#holiday-hack-challenge-logo" title="Permanent link">&para;</a></h3>
<p>If you're not feeling warm and fuzzy yet with your hot chocolate, don't worry you'll get there.</p>
<p>This year's logo looked interesting. Lets take a look at the logo.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image238.PNG"
     alt="">
    <br>
    Kringlecon 2 - ELF University Logo
</div>
<p><br>  </p>
<p>There is latin on the logo <code>Ille Te videt dum dormit</code>.</p>
<p>Using google translator, it gives two different possible translation:</p>
<div class="highlight"><pre><span></span><code>Ille Te videt dum dormit = We see him while he sleeps
Ille Te videt = He sees you
dum dormit = while sleeping
</code></pre></div>
<p>Then there is this all seeing eye on the logo.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image239.PNG"
     alt="">
    <br>
    Kringlecon 2 - Santa's All Seeing Eye?
</div>
<p><br>  </p>
<p>Here are some of the rejected Logos:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image28.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'rejected-elfu-logos.txt'
</div>
<p><br>  </p>
<p>Hopefully you're feeling warm and fuzzy by now. Lets start the Holiday hack challenge!</p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-0-talk-to-santa-in-the-quad">Objective 0 - Talk to Santa in the Quad<a class="headerlink" href="#objective-0-talk-to-santa-in-the-quad" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"A positive attitude will help you and the world." -hacks4pancake</td>
</tr>
<tr>
<td>Objective</td>
<td>Enter the campus quad and talk to Santa.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>0</td>
</tr>
<tr>
<td>Links</td>
<td>n/a</td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=RplOa_lqXvk&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">Lesley Carhart, Over 90,000: Ups and Downs of my InfoSec Twitter Journey</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="objective-0-walkthrough">Objective 0 - Walkthrough<a class="headerlink" href="#objective-0-walkthrough" title="Permanent link">&para;</a></h3>
<p>As you enter the game you're greeted by Santa. He has the following message for you:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image04.PNG" alt="">
    <br>
    Kringlecon 2 - Santa at Entrance
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image03.PNG" alt="">
    <br>
    Kringlecon 2 - Santa's Message
</div>
<p><br>  </p>
<p>As you explore and enter the campus quad, you find Santa waiting there.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image05.PNG" alt="">
    <br>
    Kringlecon 2 - Santa in Campus
</div>
<p><br>  </p>
<p><br></p>
<h3 id="objective-0-solution">Objective 0 - Solution<a class="headerlink" href="#objective-0-solution" title="Permanent link">&para;</a></h3>
<p>Answer:
<div class="highlight"><pre><span></span><code>Talk to Santa in Campus.
</code></pre></div></p>
<p>He has the following message for you which starts the game:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image06.PNG" alt="">
    <br>
    Kringlecon 2 - Storyline
</div>
<p><br>  </p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-1-find-the-turtle-doves">Objective 1 - Find the Turtle Doves<a class="headerlink" href="#objective-1-find-the-turtle-doves" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"In our hacker community, we're all family." -John Hammond</td>
</tr>
<tr>
<td>Objective</td>
<td>Find the missing turtle doves.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>0</td>
</tr>
<tr>
<td>Links</td>
<td>n/a</td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=D5Nwg84cV1E&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">John Hammond, 5 Steps to Build and Lead a Team of Holly Jolly Hackers</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="objective-1-walkthrough">Objective 1 - Walkthrough<a class="headerlink" href="#objective-1-walkthrough" title="Permanent link">&para;</a></h3>
<p>As you walk and explore the campus you get to see the different areas you have access to.</p>
<p>Once you explore the student union, you will find the solution to this challenge.
<br></p>
<h4 id="objective-1-solution">Objective 1 - Solution<a class="headerlink" href="#objective-1-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Dove&#39;s are in the student union by the fireplace.
</code></pre></div></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image07.PNG" alt="">
    <br>
    Kringlecon 2 - Michael and Jane - Two Turtle Doves
</div>
<p><br>  </p>
<p>Very important message from the Doves:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image08.PNG" alt="">
    <br>
    Kringlecon 2 - Message from the Doves
</div>
<p><br>  </p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-2-unredact-threatening-document">Objective 2 - Unredact Threatening Document<a class="headerlink" href="#objective-2-unredact-threatening-document" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Pull That Thread." -Good Elf</td>
</tr>
<tr>
<td>Objective</td>
<td>Someone sent a threatening letter to Elf University. What is the first word in ALL CAPS in the subject line of the letter? Please find the letter in the Quad.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>1</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/LetterToElfUPersonnel.pdf">LetterToElfUPersonnel.pdf</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=IEbLOvT4Fts&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">Heather Mahalik, When Malware Goes Mobile, Quick Detection is Critical</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="objective-2-walkthrough">Objective 2 - Walkthrough<a class="headerlink" href="#objective-2-walkthrough" title="Permanent link">&para;</a></h3>
<p>As you walk around the quad and explore you find the following document in north west corner of the quad.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image10.PNG" alt="">
    <br>
    Kringlecon 2 - LetterToElfUPersonnel.pdf
</div>
<p><br>  </p>
<p>As you open the document and examine it, you notice that you can highlight everything in the document.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image11.PNG" alt="">
    <br>
    Kringlecon 2 - LetterToElfUPersonnel.pdf content
</div>
<p><br>  </p>
<p>You select everything and press 'CTRL-C' to copy everything.</p>
<p>You paste the content in a text editor to view the message:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image12.PNG"
     alt="">
    <br>
    Kringlecon 2 - LetterToElfUPersonnel.pdf content
</div>
<p><br>  </p>
<p><br></p>
<h4 id="objective-2-solution">Objective 2 - Solution<a class="headerlink" href="#objective-2-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>DEMAND
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-3-windows-log-analysis-evaluate-attack-outcome">Objective 3 - Windows Log Analysis: Evaluate Attack Outcome<a class="headerlink" href="#objective-3-windows-log-analysis-evaluate-attack-outcome" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"<strike>Roads?</strike> Logs? Where we're going we don't need <strike>Roads</strike> Logs." -Mark Baggett</td>
</tr>
<tr>
<td>Objective</td>
<td>We're seeing attacks against the Elf U domain! Using the event log data, identify the user account that the attacker compromised using a password spray attack. Bushy Evergreen is hanging out in the train station and may be able to help you out.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>1</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/Security.evtx.zip">Security.evtx.zip</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=Dx78oObfiBM&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">Mark Baggett, Logs? Where we're going we don't need logs</a></td>
</tr>
<tr>
<td>Tools</td>
<td><a href="https://github.com/MarkBaggett/srum-dump">SRUM-DUMP</a>, <a href="https://github.com/MarkBaggett/ese-analyst">ESE2CSV</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="escape-ed-terminal-challenge">Escape Ed - Terminal Challenge<a class="headerlink" href="#escape-ed-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Bushy Evergreen</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="http://cs.wellesley.edu/~cs249/Resources/ed_is_the_standard_text_editor.html">ed Editor Basics</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://www.ericconrad.com/2016/09/deepbluecli-powershell-module-for-hunt.html">Deep Blue CLI Posting</a>, <a href="https://github.com/sans-blue-team/DeepBlueCLI">Deep Blue CLI on Github</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image13.PNG"
     alt="">
    <br>
    Kringlecon 2 - Escape Ed - Terminal Challenge
</div>
<p><br>  </p>
<p>After you read the ed Editor Basics you find the solution for this terminal challenge.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image14.PNG"
     alt="">
    <br>
    Kringlecon 2 - Escape Ed - Terminal Challenge
</div>
<p><br></p>
<h4 id="escape-ed-solution">Escape Ed - Solution<a class="headerlink" href="#escape-ed-solution" title="Permanent link">&para;</a></h4>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image15.PNG"
     alt="">
    <br>
    Kringlecon 2 - Escape Ed - Terminal Challenge
</div>
<p><br></p>
<p>Answer:
<div class="highlight"><pre><span></span><code>Press q and press Enter.
</code></pre></div></p>
<p>Message from Bushy Evergreen after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image16.PNG"
     alt="">
    <br>
    Kringlecon 2 - Objective 3 Hint
</div>
<p><br></p>
<p><br></p>
<h3 id="objective-3-walkthrough">Objective 3 - Walkthrough<a class="headerlink" href="#objective-3-walkthrough" title="Permanent link">&para;</a></h3>
<p>After you solve the terminal challenge, you learn about Deep Blue CLI.</p>
<p>You download Deep Blue CLI and run it against the 'security.evtx' file for the challenge.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image17.PNG"
     alt="">
    <br>
    Deep Blue CLI - Partial result of '.\DeepBlue.ps1 .\Security.evtx '
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image18.PNG"
     alt="">
    <br>
    Deep Blue CLI - Partial result of '.\DeepBlue.ps1 .\Security.evtx '
</div>
<p><br></p>
<p>When you view the Total Logon Failures, you quickly notice that all except one account have '77' failures. This may indicate that the account was authenticated successfully on the 77<sup>th</sup> attempt.
<br></p>
<h4 id="objective-3-solution">Objective 3 - Solution<a class="headerlink" href="#objective-3-solution" title="Permanent link">&para;</a></h4>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image19.PNG"
     alt="">
    <br>
    Deep Blue CLI - Partial result of '.\DeepBlue.ps1 .\Security.evtx '
</div>
<p><br></p>
<p>Answer:
<div class="highlight"><pre><span></span><code>supatree
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-4-windows-log-analysis-determine-attacker-technique">Objective 4 - Windows Log Analysis: Determine Attacker Technique<a class="headerlink" href="#objective-4-windows-log-analysis-determine-attacker-technique" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Go Hack it!" -kaknowles</td>
</tr>
<tr>
<td>Objective</td>
<td>Using these normalized Sysmon logs, identify the tool the attacker used to retrieve domain password hashes from the lsass.exe process. For hints on achieving this objective, please visit Hermey Hall and talk with SugarPlum Mary.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>2</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/sysmon-data.json.zip">sysmon-data.json.zip</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href=""></a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="linux-path-terminal-challenge">Linux Path - Terminal Challenge<a class="headerlink" href="#linux-path-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>SugarPlum Mary</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td>Green words matter, files must be found, and the terminal's $PATH matters.</td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://pen-testing.sans.org/blog/2019/12/10/eql-threat-hunting/">EQL Threat Hunting</a>, <a href="https://www.darkoperator.com/blog/2014/8/8/sysinternals-sysmon">Sysmon By Carlos Perez</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image20.PNG"
     alt="">
    <br>
    Kringlecon 2 - Linux Path
</div>
<p><br>  </p>
<p>You open the terminal.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image21.PNG"
     alt="">
    <br>
    Kringlecon 2 - Linux Path Terminal
</div>
<p><br>  </p>
<p>The objective is to get a listing of the current directory. You try the obvious solutions.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image23.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'ls' and 'dir'
</div>
<p><br>  </p>
<p>You remember the objective mentions that green words matter.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image24.PNG"
     alt="">
    <br>
    Kringlecon 2 - which ls
</div>
<p><br>  </p>
<p>You try to find other programs that start with 'ls' .</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image22.PNG"
     alt="">
    <br>
    Kringlecon 2 - locate '/ls/
</div>
<p><br>  </p>
<p>You check the Path.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image25.PNG"
     alt="">
    <br>
    Kringlecon 2 - echo $PATH
</div>
<p><br>  </p>
<p>You run '/bin/ls' to get dir listing.
<br></p>
<h4 id="linux-path-solution">Linux Path - Solution<a class="headerlink" href="#linux-path-solution" title="Permanent link">&para;</a></h4>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image27.PNG"
     alt="">
    <br>
    Kringlecon 2 - '/bin/ls'
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image28.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'rejected-elfu-logos.txt'
</div>
<p><br>  </p>
<p>Answer:
<div class="highlight"><pre><span></span><code>/bin/ls
</code></pre></div></p>
<p>Message from SugarPlum Mary after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image29.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'rejected-elfu-logos.txt'
</div>
<p><br>  </p>
<p><br></p>
<h3 id="objective-4-walkthrough">Objective 4 - Walkthrough<a class="headerlink" href="#objective-4-walkthrough" title="Permanent link">&para;</a></h3>
<p>You read the hints provided by SugarPlum Mary. You run the following three queries to solve this challenge:</p>
<p>Query 1:
<div class="highlight"><pre><span></span><code>$ eql query -f sysmon-data.json &quot;process where process_name = &#39;lsass.exe&#39;&quot;
</code></pre></div></p>
<p>Query 1 gives you no results. You continue your journey with query 2.</p>
<p>Query 2:
<div class="highlight"><pre><span></span><code>$ eql query -f sysmon-data.json &quot;process where parent_process_name = &#39;lsass.exe&#39;&quot; &gt; results.json
</code></pre></div></p>
<p>You receive the following results from Query 2:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image30.PNG"
     alt="">
    <br>
    Kringlecon 2 - Query 2 results
</div>
<p><br>  </p>
<p>You pivot on PID and run Query 3.</p>
<p>Query 3:
<div class="highlight"><pre><span></span><code>eql query -f sysmon-data.json &quot;process where ppid = 3440&quot; &gt; results.json
</code></pre></div></p>
<p>You get the following result:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image31.PNG"
     alt="">
    <br>
    Kringlecon 2 - Query 3 results
</div>
<p><br>  </p>
<p><br></p>
<h4 id="objective-4-solution">Objective 4 - Solution<a class="headerlink" href="#objective-4-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>ntdsutil
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-5-network-log-analysis-determine-compromised-system">Objective 5 - Network Log Analysis: Determine Compromised System<a class="headerlink" href="#objective-5-network-log-analysis-determine-compromised-system" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Tackle problems one step at a time. Take regular cocoa breaks!!" - kaknowles</td>
</tr>
<tr>
<td>Objective</td>
<td>The attacks don't stop! Can you help identify the IP address of the malware-infected system using these Zeek logs? For hints on achieving this objective, please visit the Laboratory and talk with Sparkle Redberry.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>2</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/elfu-zeeklogs.zip">Zeek logs</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=jxOZ5u2CYWw&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP&amp;index=2">John Strand, Keynote: A Hunting We Must Go</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="xmas-cheer-laser-terminal-challenge">Xmas Cheer Laser - Terminal Challenge<a class="headerlink" href="#xmas-cheer-laser-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Sparkle Redberry</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="https://blogs.sans.org/pen-testing/files/2016/05/PowerShellCheatSheet_v41.pdf">SANS' PowerShell Cheat Sheet</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://www.activecountermeasures.com/free-tools/rita/">RITA's homepage</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image33.PNG"
     alt="">
    <br>
    Kringlecon 2 - Xmas Cheer Laser - Terminal Challenge
</div>
<p><br>  </p>
<p>You load the terminal for this challenge.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image34.PNG"
     alt="">
    <br>
    Kringlecon 2 - Xmas Cheer Laser - Terminal Challenge
</div>
<p><br>  </p>
<p>You run the command <code>(Invoke-WebRequest -Uri http://localhost:1225/).RawContent</code> for more info.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image35.PNG"
     alt="">
    <br>
    Kringlecon 2 - Invoke-WebRequest -Uri http://localhost:1225/).RawContent
</div>
<p><br>  </p>
<p>You do a directory listing to see what files are in the current directory. You read the callingcard.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image36.PNG"
     alt="">
    <br>
    Kringlecon 2 - Callingcard.txt
</div>
<p><br>  </p>
<p>The calling card has references to history. You view the history.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image37.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'history'
</div>
<p><br>  </p>
<p>You notice Item 7 and 9 in history looks interesting.</p>
<p>You make a note of Item 7, <code>(Invoke-WebRequest -Uri http://localhost:1225/api/angle?val=65.5).RawContent</code>.</p>
<p>You're unable to read all of item 9, you dump history with all the properties.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image41.PNG"
     alt="">
    <br>
    Kringlecon 2 - riddle in history
</div>
<p><br>  </p>
<p>You ponder on the riddle in the history item for a little while... You realize the riddle is referring to environment variables. You view the environment variables in the terminal.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image42.PNG"
     alt="">
    <br>
    Kringlecon 2 - Environment variables
</div>
<p><br>  </p>
<p>You notice an environment variable named 'riddle'. You can't view the full content of the variable. You use <code>out-string width 4096</code> to view more. You view the content of this environment variable.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image43.PNG"
     alt="">
    <br>
    Kringlecon 2 - Environment variables expanded
</div>
<p><br>  </p>
<p>You compose a command line to search /etc recursively to look for the newest file that is likely compressed.</p>
<div class="highlight"><pre><span></span><code>get-childitem -Path /etc recurse -ErrorAction SilentlyContinue |  where-object {$_.lastwritetime -gt (get-date).addDays(-1)} |  where-object {-not $_.PSIsContainer} | Foreach-Object { $_.FullName + &quot; &quot; + $_.lastwritetime}
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image44.PNG"
     alt="">
    <br>
    Kringlecon 2 - Riddle solution
</div>
<p><br>  </p>
<p>You expand the 'archive' file using the command <code>Expand-Archive -LiteralPath /etc/apt/archive -DestinationPath /home/elf/archive</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image45.PNG"
     alt="">
    <br>
    Kringlecon 2 - Expanding 'archive' file
</div>
<p><br>  </p>
<p>You examine the content.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image46.PNG"
     alt="">
    <br>
    Kringlecon 2 - dir 'archive' file
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image47.PNG"
     alt="">
    <br>
    Kringlecon 2 - dir 'archive' file
</div>
<p><br>  </p>
<p>You find two files, another riddle and <code>runme.elf</code>.</p>
<p>You read the riddle.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image48.PNG"
     alt="">
    <br>
    Kringlecon 2 - riddle in 'archive' file
</div>
<p><br>  </p>
<p>You have difficulty running the <code>runme.elf</code>. You google how to run elf file, you find the following article:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image57.PNG"
     alt="">
    <br>
    Kringlecon 2 - how to run 'elf' file
</div>
<p><br>  </p>
<p>You try changing the attribute of the file prior to running it.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image58.PNG"
     alt="">
    <br>
    Kringlecon 2 - 'runme.elf'
</div>
<p><br>  </p>
<p>You make a note of the refraction value.</p>
<p>You use the following powershell command to find a file with the specified md5 hash.</p>
<p><code>Get-ChildItem /home/elf -File -Recurse | Select DirectoryName,Name,@{N='Version';E={$_.VersionInfo.ProductVersion}},LastWriteTime,Length,@{N='FileHash';E={(Get-FileHash -Algorithm MD5 $_).Hash}} | select-string "25520151A320B5B0D21561F92C8F6224"</code></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image49.PNG"
     alt="">
    <br>
    Kringlecon 2 - File with MD5 hash "25520151A320B5B0D21561F92C8F6224"
</div>
<p><br>  </p>
<p>You view this file.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image50.PNG"
     alt="">
    <br>
    Kringlecon 2 - Another riddle
</div>
<p><br>  </p>
<p>You make a note of the temperature. You find another riddle in this file.</p>
<p>You create the following powershell command to solve the riddle:</p>
<div class="highlight"><pre><span></span><code>get-childitem -Path /home/elf/depths/ recurse -ErrorAction SilentlyContinue  | Foreach-Object { $_.FullName } | sort { $_.length } |
</code></pre></div>
<p>The results are as follow:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image51.PNG"
     alt="">
    <br>
    Kringlecon 2 - Riddle solution
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image52.PNG"
     alt="">
    <br>
    Kringlecon 2 - Yet another riddle.
</div>
<p><br>  </p>
<p>You use the following powershell command to solve the above riddle.</p>
<div class="highlight"><pre><span></span><code>Get-Process -IncludeUserName | Select-Object Id,Name,Username,Path
Stop-Process -ID 23 -Force
Stop-Process -ID 26 -Force
Stop-Process -ID 27 -Force
Stop-Process -ID 29 -Force
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image53.PNG"
     alt="">
    <br>
    Kringlecon 2 - Yet another riddle.
</div>
<p><br>  </p>
<p>You do a dir listing of <code>/shall</code> to find another riddle. You use the following powershell command to solve this riddle.</p>
<div class="highlight"><pre><span></span><code>get-childitem -Path /etc *.xml recurse -ErrorAction SilentlyContinue
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image54.PNG"
     alt="">
    <br>
    Kringlecon 2 - Riddle solution
</div>
<p><br>  </p>
<p>You ponder on how to this. After a while you try the following command:</p>
<div class="highlight"><pre><span></span><code>type /etc/systemd/system/timers.target.wants/EventLog.xml | Select-String &quot;&lt;I32 N=&quot;&quot;Id&quot;&quot;&gt;&quot; | Group-Object
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image55.PNG"
     alt="">
    <br>
    Kringlecon 2 - lonely event id
</div>
<p><br>  </p>
<p>You use the following powershell command to get the properties of the lonely event id.</p>
<div class="highlight"><pre><span></span><code>type /etc/systemd/system/timers.target.wants/EventLog.xml | Select-String &quot;&lt;I32 N=&quot;&quot;Id&quot;&quot;&gt;1&lt;/I32&gt;&quot; -Context 1,150
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image56.PNG"
     alt="">
    <br>
    Kringlecon 2 -'$correct_gases_postbody'
</div>
<p><br>  </p>
<p>You make a note of the correct gases.</p>
<p>Now you have the temperature, angle, gas composition, refraction value. You set the correct parameters on the laser.</p>
<p><br></p>
<h4 id="xmas-cheer-laser-solution">Xmas Cheer Laser - Solution<a class="headerlink" href="#xmas-cheer-laser-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">off</span><span class="p">).</span><span class="n">RawContent</span>
<span class="p">(</span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">refraction</span><span class="k">?</span><span class="n">val</span><span class="p">=</span><span class="n">1</span><span class="p">.</span><span class="n">867</span><span class="p">).</span><span class="n">RawContent</span>
<span class="p">(</span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">temperature</span><span class="k">?</span><span class="n">val</span><span class="p">=-</span><span class="n">33</span><span class="p">.</span><span class="n">5</span><span class="p">).</span><span class="n">RawContent</span>
<span class="p">(</span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">angle</span><span class="k">?</span><span class="n">val</span><span class="p">=</span><span class="n">65</span><span class="p">.</span><span class="n">5</span><span class="p">).</span><span class="n">RawContent</span>
<span class="nv">$correct_gases_postbody</span> <span class="p">=</span> <span class="s2">&quot;O=6&amp;H=7&amp;He=3&amp;N=4&amp;Ne=22&amp;Ar=11&amp;Xe=10&amp;F=20&amp;Kr=8&amp;Rn=9&quot;</span>
<span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">gas</span> <span class="n">-Method</span> <span class="n">POST</span> <span class="n">-Body</span> <span class="nv">$correct_gases_postbody</span>
<span class="p">(</span><span class="nb">Invoke-WebRequest</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">localhost</span><span class="p">:</span><span class="n">1225</span><span class="p">/</span><span class="n">api</span><span class="p">/</span><span class="n">on</span><span class="p">).</span><span class="n">RawContent</span>
</code></pre></div></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image59.PNG"
     alt="">
    <br>
    Xmas Cheer Laser - Solution
</div>
<p><br>  </p>
<p>Message from Sparkle Redberry after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image60.PNG"
     alt="">
    <br>
    Xmas Cheer Laser - Solution
</div>
<p><br>  </p>
<p><br></p>
<h3 id="objective-5-walkthrough">Objective 5 - Walkthrough<a class="headerlink" href="#objective-5-walkthrough" title="Permanent link">&para;</a></h3>
<p>You read the Rita hint from the terminal challenge and watch the related video. You're now a RITA expert!</p>
<p>You extract the Zeek files provided in this challenge. You view the RITA output.</p>
<p>You view the Beacons:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image61.PNG"
     alt="">
    <br>
    RITA - Beacons
</div>
<p><br>  </p>
<p><br></p>
<h4 id="objective-5-solution">Objective 5 - Solution<a class="headerlink" href="#objective-5-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>144.202.46.214
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-6-splunk">Objective 6 - Splunk<a class="headerlink" href="#objective-6-splunk" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Set boundaries (time, abuse, triggers, requests, pancakes...)" -hacks4pancake</td>
</tr>
<tr>
<td>Objective</td>
<td>Access <a href="https://splunk.elfu.org/">https://splunk.elfu.org/</a> as elf with password elfsocks. What was the message for Kent that the adversary embedded in this attack? The SOC folks at that link will help you along! For hints on achieving this objective, please visit the Laboratory in Hermey Hall and talk with Prof. Banas.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>3</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://splunk.elfu.org/">https://splunk.elfu.org/</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=qbIhHhRKQCw&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">James Brodsky, Dashing Through the Logs</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="splunk-training-questions-terminal-challenge">Splunk Training Questions - Terminal Challenge<a class="headerlink" href="#splunk-training-questions-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Professor Banas</td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image62.PNG"
     alt="">
    <br>
    Kringlecon 2 - Splunk Training
</div>
<p><br>  </p>
<p>You proceed to login to <code>https://splunk.elfu.org/ wither username elf/Password:elfsocks</code>.</p>
<p>Once you log in, you're greeted with the following messages:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image63.PNG"
     alt="">
    <br>
    Kringlecon 2 - https://splunk.elfu.org/ welcome page
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image64.PNG"
     alt="">
    <br>
    Kringlecon 2 - https://splunk.elfu.org/ ELF University SOC
</div>
<p><br>  </p>
<p>The various Chats will help you answer the training questions and the challenge questions.</p>
<p>Here is the list of the questions:</p>
<div class="highlight"><pre><span></span><code>Question 1:  
What is the short host name of Professor Banas&#39; computer?

Question 2:  
What is the name of the sensitive file that was likely accessed and copied by the attacker? Please provide the fully qualified location of the file. (Example: C:\temp\report.pdf)      

Question 3:  
What is the fully-qualified domain name(FQDN) of the command and control(C2) server? (Example: badguy.baddies.com)      

Question 4:
What document is involved with launching the malicious PowerShell code? Please provide just the filename. (Example: results.txt)        

Question 5:
How many unique email addresses were used to send Holiday Cheer essays to Professor Banas? Please provide the numeric value. (Example: 1)       

Question 6:
What was the password for the zip archive that contained the suspicious file?       
</code></pre></div>
<p>You work with the users in SOC to answer these questions. They walk you through answering each question. You read the chat and perform the searches, review the results to answer the questions.</p>
<p>For question 1 you review <code>#ELFU SOC</code> chat log.<br />
For question 2, you search <code>index=main santa</code> and review the results.<br />
For question 3, you search for <code>index=main sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational powershell EventCode=3</code><br />
For question 4, you search for <code>index=main sourcetype=WinEventLog EventCode=4688 | reverse</code> and review the events.<br />
For question 5, you search for <code>index=main sourcetype=stoq | table _time results{}.workers.smtp.to results{}.workers.smtp.from  results{}.workers.smtp.subject results{}.workers.smtp.body | search results{}.workers.smtp.subject="*Holiday
 Cheer Assignment Submission*" results{}.workers.smtp.to="*carl*"</code><br />
For question 6, you can find the password in the malicious email carl received in question 5.</p>
<p><br></p>
<h4 id="splunk-training-questions-solution">Splunk Training Questions - Solution<a class="headerlink" href="#splunk-training-questions-solution" title="Permanent link">&para;</a></h4>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image73.PNG"
     alt="">
    <br>
    Kringlecon 2 - Training Questions/Answers
</div>
<p><br>  </p>
<p>Answer:
<div class="highlight"><pre><span></span><code>Training Questions
1. sweetums
2. C:\Users\cbanas\Documents\Naughty_and_Nice_2019_draft.txt
3. 144.202.46.214.vultr.com
4. 19th Century Holiday Cheer Assignment.docm
5. 21
6. 123456789
7. Bradly.Buttercups@eIfu.org
</code></pre></div></p>
<p><br></p>
<h3 id="objective-6-walkthrough">Objective 6 - Walkthrough<a class="headerlink" href="#objective-6-walkthrough" title="Permanent link">&para;</a></h3>
<p><div class="highlight"><pre><span></span><code>Challenge Question:
What was the message for Kent that the adversary embedded in this attack?
</code></pre></div>
Alice Bluebeard assists you with this challenge. Here is a list of files of interest:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image76.PNG"
     alt="">
    <br>
    Kringlecon 2 - List of interesting files
</div>
<p><br>  </p>
<p>You will use the following splunk search get a list of files that may contain the message for Kent:</p>
<div class="highlight"><pre><span></span><code>index=main sourcetype=stoq  &quot;results{}.workers.smtp.from&quot;=&quot;bradly buttercups &lt;bradly.buttercups@eifu.org&gt;&quot;
| eval results = spath(_raw, &quot;results{}&quot;)
| mvexpand results
| eval path=spath(results, &quot;archivers.filedir.path&quot;), filename=spath(results, &quot;payload_meta.extra_data.filename&quot;), fullpath=path.&quot;/&quot;.filename
| search fullpath!=&quot;&quot;
| table filename,fullpath
</code></pre></div>
<p>You will get the following results:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image75.PNG"
     alt="">
    <br>
    Kringlecon 2 - Files
</div>
<p><br>  </p>
<p>Looking at the malicious file you get the following message:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image77.PNG"
     alt="">
    <br>
    Kringlecon 2 - malicious file
</div>
<p><br>  </p>
<p>You try a different file and see the following:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image78.PNG"
     alt="">
    <br>
    Kringlecon 2 - xml file
</div>
<p><br>  </p>
<p><br></p>
<h4 id="objective-6-solution">Objective 6 - Solution<a class="headerlink" href="#objective-6-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Kent you are so unfair. And we were going to make you the king of the Winter Carnival.
</code></pre></div></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image74.PNG"
     alt="">
    <br>
    Kringlecon 2 - Challenge Answer
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image79.PNG"
     alt="">
    <br>
    Kringlecon 2 - Challenge Answer
</div>
<p><br>  </p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-7-get-access-to-the-steam-tunnels">Objective 7 - Get Access To The Steam Tunnels<a class="headerlink" href="#objective-7-get-access-to-the-steam-tunnels" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Deep breath, Loook at the data!" - Random Math Professor standing behind you</td>
</tr>
<tr>
<td>Objective</td>
<td>Gain access to the steam tunnels. Who took the turtle doves? Please tell us their first and last name. For hints on achieving this objective, please visit Minty's dorm room and talk with Minty Candy Cane.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>3</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://github.com/deviantollam/decoding/tree/master/Key%20Decoding">Key Decoding</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=KU6FJnbkeLA&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">Deviant Ollam, Optical Decoding of Keys</a></td>
</tr>
</tbody>
</table>
<p>Prior to accessing the terminal challenge we need to unlock the dorm room.
<br></p>
<h3 id="frosty-keypad-challenge">Frosty Keypad Challenge<a class="headerlink" href="#frosty-keypad-challenge" title="Permanent link">&para;</a></h3>
<p>Here is the keypad to access the dorm room:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image80.PNG"
     alt="">
    <br>
    Kringlecon 2 - Frosty Keypad
</div>
<p><br>  </p>
<p>The Elf Tangle Coalbox by the dorm door gives you the following hints:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image81.PNG"
     alt="">
    <br>
    Kringlecon 2 - Elf Tangle Coalbox
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image82.PNG"
     alt="">
    <br>
    Kringlecon 2 - Frosty Keypad Hints
</div>
<p><br>  </p>
<p>From the keypad and the hints you can tell the three keys in the code are '1', '3' and '7'.</p>
<p>You write the following python function to find all the 4 digit prime numbers with only the digits '1', '3', '7'.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># prime function from https://stackoverflow.com/questions/15285534/isprime-function-for-python-language</span>
<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
  <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
  <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
  <span class="n">f</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="k">while</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">:</span>
    <span class="c1">#print (&#39;\t&#39;,f)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="p">(</span><span class="n">f</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
    <span class="n">f</span> <span class="o">+=</span><span class="mi">6</span>
  <span class="k">return</span> <span class="kc">True</span>    


<span class="c1"># Program to check if a number is prime or not</span>

<span class="c1"># for number in range(1000:10000)</span>

<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="c1">#print(x + &#39; is Prime.&#39;)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span>  <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">)</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>    
                <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="s1">&#39; is Prime.&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Here are the result of the above program:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image84.PNG"
     alt="">
    <br>
    Kringlecon 2 - Frosty Keypad Possible Combinations
</div>
<p><br>  </p>
<h4 id="frosty-keypad-solution">Frosty Keypad - Solution<a class="headerlink" href="#frosty-keypad-solution" title="Permanent link">&para;</a></h4>
<p>You try all the above combinations and find the correct combination is <code>7331</code>. Once you enter the dorm room, you notice that the combination is written on the wall.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image85.PNG"
     alt="">
    <br>
    Kringlecon 2 - Dorm Room - Bad Security
</div>
<p><br></p>
<h3 id="holiday-hack-trial-terminal-challenge">Holiday Hack Trial - Terminal Challenge<a class="headerlink" href="#holiday-hack-trial-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Misty CandyCane</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="https://youtu.be/0T6-DQtzCgM">Web Apps: A Trailhead</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://github.com/deviantollam/decoding">Deviant's Key Decoding Templates</a>,<a href="https://youtu.be/KU6FJnbkeLA">Optical Decoding of Keys</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image87.PNG"
     alt="">
    <br>
    Kringlecon 2 - Minty Candycane
</div>
<p><br>  </p>
<p>The game has 3 difficulty levels. You notice a URL on top of the game page.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image88.PNG"
     alt="">
    <br>
    Kringlecon 2 - Holiday Hack Trail - Terminal Challenge
</div>
<p><br>  </p>
<h4 id="easy-mode">Easy mode<a class="headerlink" href="#easy-mode" title="Permanent link">&para;</a></h4>
<p>You select the EASY mode. You notice the URL on top of the game has changed.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image89.PNG"
     alt="">
    <br>
    Kringlecon 2 - Easy mode
</div>
<p><br>  </p>
<p>You copy and paste the URI to a text editor:</p>
<div class="highlight"><pre><span></span><code>hhc://trail.hhc/trail/?difficulty=0&amp;distance=0&amp;money=3600&amp;pace=0&amp;curmonth=7&amp;curday=1&amp;reindeer=4&amp;runners=4&amp;ammo=100&amp;meds=20&amp;food=400&amp;name0=Anna&amp;health0=100&amp;cond0=0&amp;causeofdeath0=&amp;deathday0=0&amp;deathmonth0=0&amp;name1=Michael&amp;health1=100&amp;cond1=0&amp;causeofdeath1=&amp;deathday1=0&amp;deathmonth1=0&amp;name2=Billy&amp;health2=100&amp;cond2=0&amp;causeofdeath2=&amp;deathday2=0&amp;deathmonth2=0&amp;name3=Vlad&amp;health3=100&amp;cond3=0&amp;causeofdeath3=&amp;deathday3=0&amp;deathmonth3=0
</code></pre></div>
<p>You update the distance variable in the URL to 8000 and press the <code>&gt;</code>.</p>
<p>You press the Go button and you get the following message:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image90.PNG"
     alt="">
    <br>
    Kringlecon 2 - Terminal Challenge Solved
</div>
<p><br>  </p>
<h4 id="medium-mode">Medium mode<a class="headerlink" href="#medium-mode" title="Permanent link">&para;</a></h4>
<p>You start the game again on Medium difficulty. You notice the URL bar has changed. You no longer can modify the variables in the URL to win.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image92.PNG"
     alt="">
    <br>
    Kringlecon 2 - Medium mode
</div>
<p><br>  </p>
<p>You inspect the elements on the page and find a div 'statusContainer' that contains hidden variables.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image93.PNG"
     alt="">
    <br>
    Kringlecon 2 - statusContainer
</div>
<p><br>  </p>
<p>You modify the distance variable to 8000 and press "Go".</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image94.PNG"
     alt="">
    <br>
    Kringlecon 2 - distance variable
</div>
<p><br>  </p>
<h4 id="hard-mode">Hard mode<a class="headerlink" href="#hard-mode" title="Permanent link">&para;</a></h4>
<p>You start the game in hard difficulty mode.</p>
<p>The solutions for the last two mode no longer work. You examine the 'statusContainer and notice now it contains a hash value.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image95.PNG"
     alt="">
    <br>
    Kringlecon 2 - hash
</div>
<p><br>  </p>
<p>You type the hash in <a href="https://crackstation.net/">Crackstation</a>.</p>
<p>You get the following result:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image96.PNG"
     alt="">
    <br>
    Kringlecon 2 - md5 hash
</div>
<p><br>  </p>
<p>The hash <code>6da9003b743b65f4c0ccd295cc484e57</code> is a md5 hash for <code>230</code>.</p>
<p>After playing around with the game for a while, you notice the hash is calculated by adding all the values together.
The Values added are money, distance, curmonth, curday, runners,reindeer, ammo, meds, food.</p>
<p>You restart the game. You add calculate the md5 hash of (8000+230).  You use <a href="https://gchq.github.io/CyberChef/">CyberChef</a> to calculate the hash.  The hash is <code>bd4a6d0563e0604510989eb8f9ff71f5</code></p>
<p>You update the distance to 8000 and hash to the above and press <code>Go</code>.</p>
<p><br></p>
<h4 id="holiday-hack-trial-solution">Holiday Hack Trial - Solution<a class="headerlink" href="#holiday-hack-trial-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Easy:

hhc://trail.hhc/trail/?difficulty=0&amp;distance=8000&amp;money=3600&amp;pace=0&amp;curmonth=7&amp;curday=1&amp;reindeer=4&amp;runners=4&amp;ammo=100&amp;meds=20&amp;food=400&amp;name0=Anna&amp;health0=100&amp;cond0=0&amp;causeofdeath0=&amp;deathday0=0&amp;deathmonth0=0&amp;name1=Michael&amp;health1=100&amp;cond1=0&amp;causeofdeath1=&amp;deathday1=0&amp;deathmonth1=0&amp;name2=Billy&amp;health2=100&amp;cond2=0&amp;causeofdeath2=&amp;deathday2=0&amp;deathmonth2=0&amp;name3=Vlad&amp;health3=100&amp;cond3=0&amp;causeofdeath3=&amp;deathday3=0&amp;deathmonth3=0

Medium:
Modify the distance variable in div &quot;statusContainer&quot; to 8000 and press &quot;Go&quot;.

Hard:
You use the same solution as Medium, except you update the hash.
The hash is md5(sum(money, distance, curmonth, curday, runners,reindeer, ammo, meds, food))
</code></pre></div></p>
<p>Message from Minty Candycane after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image91.PNG"
     alt="">
    <br>
    Kringlecon 2 - Minty Candycane - Terminal Challenge
</div>
<p><br>  </p>
<p><br></p>
<h3 id="objective-7-walkthrough">Objective 7 - Walkthrough<a class="headerlink" href="#objective-7-walkthrough" title="Permanent link">&para;</a></h3>
<p>You watch the video for this challenge. You review the elements on the page and notice a class called "krampus scampering".</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image97.PNG"
     alt="">
    <br>
    Kringlecon 2 - "krampus scampering"
</div>
<p><br>  </p>
<p>You open the <a href="https://2019.kringlecon.com/images/avatars/elves/krampus.png">image</a> mentioned in the krampus class in your browser.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image98.png"
     alt="">
    <br>
    Kringlecon 2 - krampus.png
</div>
<p><br>  </p>
<p>You cut the key image and rotate it.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image99.png"
     alt="">
    <br>
    Kringlecon 2 - krampus's key
</div>
<p><br>  </p>
<p>You have two options, use the templates provided for the challange or try to eyeball it.</p>
<p>You decide to eyeball it.</p>
<p>You trying the following combinations</p>
<div class="highlight"><pre><span></span><code>133430
133530
133630
133730
233530
122420
122520(answer)
</code></pre></div>
<p>The door opens up with <code>122520</code> key.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image100.PNG"
     alt="">
    <br>
    Kringlecon 2 - Door opened by key `122520`
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image101.png"
     alt="">
    <br>
    Kringlecon 2 - Key `122520`
</div>
<p><br>  </p>
<p>You through the door and down the steam tunnel. You reach the end of the steam tunnel.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image102.png"
     alt="">
    <br>
    Kringlecon 2 - Krampus / Frido Sleigh Contest
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image103.PNG"
     alt="">
    <br>
    Kringlecon 2 - Krampus Hollyfeld
</div>
<p><br>  </p>
<p><br></p>
<h4 id="objective-7-solution">Objective 7 - Solution<a class="headerlink" href="#objective-7-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Krampus Hollyfeld
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-8-bypassing-the-frido-sleigh-capteha">Objective 8 - Bypassing the Frido Sleigh CAPTEHA<a class="headerlink" href="#objective-8-bypassing-the-frido-sleigh-capteha" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Being devious is half of the fun!" -kaknowles</td>
</tr>
<tr>
<td>Objective</td>
<td>Help Krampus beat the Frido Sleigh contest. For hints on achieving this objective, please talk with Alabaster Snowball in the Speaker Unpreparedness Room.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>4</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://fridosleigh.com/">Frido Sleigh contest</a>, <a href="https://downloads.elfu.org/capteha_images.tar.gz">12,000 images</a>, <a href="https://downloads.elfu.org/capteha_api.py">API interface </a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=jmVPLwjm_zs">Chris Davis, Machine Learning Use Cases for Cybersecurity</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="nyanshell-terminal-challenge">Nyanshell - Terminal Challenge<a class="headerlink" href="#nyanshell-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Alabaster Snowball</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td>On Linux, a user's shell is determined by the contents of /etc/passwd, sudo -l says I can run a command as root. What does it do?</td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://www.youtube.com/watch?v=jmVPLwjm_zs">Chris Davis, Machine Learning Use Cases for Cybersecurity</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<p>You arrive in the Speaker Unpreparedness Room.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image113.PNG"
     alt="">
    <br>
    Kringlecon 2 - Speaker Unpreparedness Room
</div>
<p><br>  </p>
<p>You talk to Alabaster Snowball.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image104.PNG"
     alt="">
    <br>
    Kringlecon 2 - Alabaster Snowball - Terminal Challenge
</div>
<p><br>  </p>
<p>You open the Nyanshell.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image105.PNG"
     alt="">
    <br>
    Kringlecon 2 - Nyanshell - Terminal Challenge
</div>
<p><br>  </p>
<p>You run <code>sudo -l</code> to see the list of files you can and can't run with sudo permission.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image106.PNG"
     alt="">
    <br>
    Kringlecon 2 - sudo -l
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image107.PNG"
     alt="">
    <br>
    Kringlecon 2 - /etc/passwd
</div>
<p><br>  </p>
<p>You look around in different folders, and you find a file /<code>entrypoint.sh</code></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image108.PNG"
     alt="">
    <br>
    Kringlecon 2 - entrypoint.sh
</div>
<p><br></p>
<p>You try running <code>entrypoint.sh</code>. You check the attribute of <code>/bin/nsh</code> using <code>lsattr /bin/nsh</code> command. You notice <code>/bin/nsh</code> is marked as immutable.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image109.PNG"
     alt="">
    <br>
    Kringlecon 2 - getting attribute of /bin/nsh
</div>
<p><br></p>
<p>You change this attribute by using <code>sudo chattr -i /bin/nsh</code> command. You copy <code>/bin/bash</code> over <code>/bin/nsh</code></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image110.PNG"
     alt="">
    <br>
    Kringlecon 2 - changing nsh from immutable to mutable
</div>
<p><br></p>
<p>You login as alabaster_snowball with the username provided on loading of the terminal (alabaster_snowball/Password2).</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image111.PNG"
     alt="">
    <br>
    Kringlecon 2 - su alabaster_snowball
</div>
<p><br></p>
<p>You run the success script after.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image112.PNG"
     alt="">
    <br>
    Kringlecon 2 - running the success script
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image114.PNG"
     alt="">
    <br>
    Kringlecon 2 - nyancat
</div>
<p><br></p>
<h4 id="nyanshell-solution">Nyanshell - Solution<a class="headerlink" href="#nyanshell-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>sudo chattr -i /bin/nsh
cp /bin/bash /bin/nsh
su alabaster_snowball with password: &quot;Password2&quot;
</code></pre></div></p>
<p>Message from Alabaster Snowball after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image115.PNG"
     alt="">
    <br>
    Kringlecon 2 - Nyanshell solved
</div>
<p><br></p>
<h3 id="objective-8-walkthrough">Objective 8 - Walkthrough<a class="headerlink" href="#objective-8-walkthrough" title="Permanent link">&para;</a></h3>
<p>You view the website for the contest, <a href="https://fridosleigh.com/">Frido Sleigh contest</a>. The website has a complex captcha puzzle.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image116.PNG"
     alt="">
    <br>
    Kringlecon 2 - Contest Captcha
</div>
<p><br></p>
<p>You watch the related video for this objective. You download all the related files for this section.</p>
<ul>
<li><a href="https://downloads.elfu.org/capteha_images.tar.gz">12,000 images</a></li>
<li><a href="https://downloads.elfu.org/capteha_api.py">API interface </a></li>
</ul>
<p>You download the repository from the video <a href="https://github.com/chrisjd20/img_rec_tf_ml_Demo">img_rec_tf_ml_demo</a>.</p>
<p>You follow the instructions on the img_rec_tf_ml_demo github page to install Tensorflow:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image117.PNG"
     alt="">
    <br>
    Kringlecon 2 - TensorFlow installation
</div>
<p><br></p>
<p>You run the demo to ensure you get the coprrect results.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image118.PNG"
     alt="">
    <br>
    Kringlecon 2 - TensorFlow Demo
</div>
<p><br></p>
<p>You download capteha_api.py file and copy it to the demo tensorflow folder.</p>
<p>You extract the 12,000 images you downloaded by running the following commands:</p>
<div class="highlight"><pre><span></span><code>mkdir training_images
tar xvzf capteha_images.tar.gz -C ./training_images
</code></pre></div>
<p>You remove the demo model training files, <code>rm -r /tmp/retrain_tmp/</code>.</p>
<p>You retrain with model with the capteha_images.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image120.PNG"
     alt="">
    <br>
    Kringlecon 2 - Training Model 1/2
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image121.PNG"
     alt="">
    <br>
    Kringlecon 2 - Training Model 2/2
</div>
<p><br></p>
<p>You review <code>capteha_api.py</code> and <code>predict_images_using_trained_model.py</code> from the tensorflow demo.</p>
<p>You add <code>capteha_api.py</code> to <code>predict_images_using_trained_model.py</code> file.</p>
<p>You write the code the extra code to use ML model to solve the captcha.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/python3</span>
<span class="c1"># Image Recognition Using Tensorflow Exmaple.</span>
<span class="c1"># Code based on example at:</span>
<span class="c1"># https://raw.githubusercontent.com/tensorflow/tensorflow/master/tensorflow/examples/label_image/label_image.py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_CPP_MIN_LOG_LEVEL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">queue</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># sudo apt install python3-pip</span>
<span class="c1"># sudo python3 -m pip install --upgrade pip</span>
<span class="c1"># sudo python3 -m pip install --upgrade setuptools</span>
<span class="c1"># sudo python3 -m pip install --upgrade tensorflow==1.15</span>

<span class="k">def</span> <span class="nf">load_labels</span><span class="p">(</span><span class="n">label_file</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">proto_as_ascii_lines</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gfile</span><span class="o">.</span><span class="n">GFile</span><span class="p">(</span><span class="n">label_file</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">proto_as_ascii_lines</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">label</span>

<span class="k">def</span> <span class="nf">predict_image</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">sess</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">image_bytes</span><span class="p">,</span> <span class="n">img_full_path</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">input_operation</span><span class="p">,</span> <span class="n">output_operation</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">read_tensor_from_image_bytes</span><span class="p">(</span><span class="n">image_bytes</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">output_operation</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">{</span>
        <span class="n">input_operation</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">image</span>
    <span class="p">})</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">5</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span> <span class="p">{</span><span class="s1">&#39;img_full_path&#39;</span><span class="p">:</span><span class="n">img_full_path</span><span class="p">,</span> <span class="s1">&#39;prediction&#39;</span><span class="p">:</span><span class="n">labels</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="s1">&#39;percent&#39;</span><span class="p">:</span><span class="n">results</span><span class="p">[</span><span class="n">prediction</span><span class="p">]}</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">load_graph</span><span class="p">(</span><span class="n">model_file</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="n">graph_def</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">GraphDef</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">graph_def</span><span class="o">.</span><span class="n">ParseFromString</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">import_graph_def</span><span class="p">(</span><span class="n">graph_def</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>

<span class="k">def</span> <span class="nf">read_tensor_from_image_bytes</span><span class="p">(</span><span class="n">imagebytes</span><span class="p">,</span> <span class="n">input_height</span><span class="o">=</span><span class="mi">299</span><span class="p">,</span> <span class="n">input_width</span><span class="o">=</span><span class="mi">299</span><span class="p">,</span> <span class="n">input_mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_std</span><span class="o">=</span><span class="mi">255</span><span class="p">):</span>
    <span class="n">image_reader</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">decode_png</span><span class="p">(</span> <span class="n">imagebytes</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;png_reader&quot;</span><span class="p">)</span>
    <span class="n">float_caster</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">image_reader</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">dims_expander</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">float_caster</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">resized</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize_bilinear</span><span class="p">(</span><span class="n">dims_expander</span><span class="p">,</span> <span class="p">[</span><span class="n">input_height</span><span class="p">,</span> <span class="n">input_width</span><span class="p">])</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">resized</span><span class="p">,</span> <span class="p">[</span><span class="n">input_mean</span><span class="p">]),</span> <span class="p">[</span><span class="n">input_std</span><span class="p">])</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Loading the Trained Machine Learning Model created from running retrain.py on the training_images directory</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">load_graph</span><span class="p">(</span><span class="s1">&#39;/tmp/retrain_tmp/output_graph.pb&#39;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">load_labels</span><span class="p">(</span><span class="s2">&quot;/tmp/retrain_tmp/output_labels.txt&quot;</span><span class="p">)</span>

    <span class="c1"># Load up our session</span>
    <span class="n">input_operation</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_operation_by_name</span><span class="p">(</span><span class="s2">&quot;import/Placeholder&quot;</span><span class="p">)</span>
    <span class="n">output_operation</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_operation_by_name</span><span class="p">(</span><span class="s2">&quot;import/final_result&quot;</span><span class="p">)</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

    <span class="c1">### capteha_api.py</span>
    <span class="c1">#yourREALemailAddress = &quot;YourRealEmail@SomeRealEmailDomain.RealTLD&quot;</span>
    <span class="n">yourREALemailAddress</span> <span class="o">=</span> <span class="s2">&quot;mo@.SomeRealEmailDomain.RealTLD.org&quot;</span>

    <span class="c1"># Creating a session to handle cookies</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://fridosleigh.com/&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sending capteha request...&quot;</span><span class="p">)</span>
    <span class="n">json_resp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">api/capteha/request&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">b64_images</span> <span class="o">=</span> <span class="n">json_resp</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">]</span>                    <span class="c1"># A list of dictionaries eaching containing the keys &#39;base64&#39; and &#39;uuid&#39;</span>
    <span class="n">challenge_image_type</span> <span class="o">=</span> <span class="n">json_resp</span><span class="p">[</span><span class="s1">&#39;select_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>     <span class="c1"># The Image types the CAPTEHA Challenge is looking for.</span>
    <span class="n">challenge_image_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; and &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="c1"># cleaning and formatting</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Challenge types:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">challenge_image_types</span><span class="p">))</span>


    <span class="c1"># Can use queues and threading to spead up the processing</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="n">unknown_images_dir</span> <span class="o">=</span> <span class="s1">&#39;unknown_images&#39;</span>
    <span class="n">unknown_images</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">unknown_images_dir</span><span class="p">)</span>

    <span class="c1">#Going to interate over each of our images.</span>
    <span class="c1">#for image in unknown_images:</span>
    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">b64_images</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;img uuid:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">]))</span>
        <span class="c1"># https://stackoverflow.com/questions/16214190/how-to-convert-base64-string-to-image</span>
        <span class="n">imgdata</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">])</span>

        <span class="c1">#img_full_path = &#39;{}/{}&#39;.format(unknown_images_dir, image)</span>

        <span class="c1">#print(&#39;Processing Image {}&#39;.format(img_full_path))</span>
        <span class="c1"># We don&#39;t want to process too many images at once. 10 threads max</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">enumerate</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>

        <span class="c1">#predict_image function is expecting png image bytes so we read image as &#39;rb&#39; to get a bytes object</span>
        <span class="c1">#image_bytes = open(img_full_path,&#39;rb&#39;).read()</span>
        <span class="n">image_bytes</span> <span class="o">=</span> <span class="n">imgdata</span>
        <span class="c1">#threading.Thread(target=predict_image, args=(q, sess, graph, image_bytes, img_full_path, labels, input_operation, output_operation)).start()</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">predict_image</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">sess</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">image_bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">]),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">input_operation</span><span class="p">,</span> <span class="n">output_operation</span><span class="p">))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting For Threads to Finish...&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">q</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">b64_images</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="c1">#getting a list of all threads returned results</span>
    <span class="n">prediction_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">qsize</span><span class="p">())]</span>
    <span class="n">final_answer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="c1">#do something with our results... Like print them to the screen.</span>
    <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">prediction_results</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">image_type</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">image_type</span> <span class="ow">in</span> <span class="n">challenge_image_types</span><span class="p">):</span>
            <span class="n">final_answer</span> <span class="o">=</span> <span class="n">final_answer</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="s2">&quot;img_full_path&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
            <span class="nb">print</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TensorFlow Predicted </span><span class="si">{img_full_path}</span><span class="s1"> is a </span><span class="si">{prediction}</span><span class="s1"> with </span><span class="si">{percent:.2%}</span><span class="s1"> Accuracy&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">prediction</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">challenge_image_types</span><span class="p">))</span>


    <span class="c1">### capteha_api.py</span>

    <span class="n">final_answer</span> <span class="o">=</span> <span class="n">final_answer</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;final answer:&quot;</span> <span class="o">+</span> <span class="n">final_answer</span><span class="p">)</span>

    <span class="c1"># This should be JUST a csv list image uuids ML predicted to match the challenge_image_type .</span>
    <span class="c1">#final_answer = &#39;,&#39;.join( [ img[&#39;uuid&#39;] for img in b64_images ] )</span>

    <span class="n">json_resp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">api/capteha/submit&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;answer&#39;</span><span class="p">:</span><span class="n">final_answer</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">json_resp</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]:</span>
        <span class="c1"># If it fails just run again. ML might get one wrong occasionally</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FAILED MACHINE LEARNING GUESS&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------</span><span class="se">\n</span><span class="s1">Our ML Guess:</span><span class="se">\n</span><span class="s1">--------------------</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">final_answer</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------</span><span class="se">\n</span><span class="s1">Server Response:</span><span class="se">\n</span><span class="s1">--------------------</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json_resp</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CAPTEHA Solved!&#39;</span><span class="p">)</span>
    <span class="c1"># If we get to here, we are successful and can submit a bunch of entries till we win</span>
    <span class="n">userinfo</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Krampus Hollyfeld&#39;</span><span class="p">,</span>
        <span class="s1">&#39;email&#39;</span><span class="p">:</span><span class="n">yourREALemailAddress</span><span class="p">,</span>
        <span class="s1">&#39;age&#39;</span><span class="p">:</span><span class="mi">180</span><span class="p">,</span>
        <span class="s1">&#39;about&#39;</span><span class="p">:</span><span class="s2">&quot;Cause they&#39;re so flippin yummy!&quot;</span><span class="p">,</span>
        <span class="s1">&#39;favorites&#39;</span><span class="p">:</span><span class="s1">&#39;thickmints&#39;</span>
    <span class="p">}</span>
    <span class="c1"># If we win the once-per minute drawing, it will tell us we were emailed.</span>
    <span class="c1"># Should be no more than 200 times before we win. If more, somethings wrong.</span>
    <span class="n">entry_response</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">entry_count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">yourREALemailAddress</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry_response</span> <span class="ow">and</span> <span class="n">entry_count</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Submitting lots of entries until we win the contest! Entry #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry_count</span><span class="p">))</span>
        <span class="n">entry_response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">api/entry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">userinfo</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">entry_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">entry_response</span><span class="p">)</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<p>You run the combined code, you get the following results:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image122.PNG"
     alt="">
    <br>
    Kringlecon 2 - Solving CAPTEHA
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image124.PNG"
     alt="">
    <br>
    Kringlecon 2 - CAPTEHA Solved!!
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image123.PNG"
     alt="">
    <br>
    Kringlecon 2 - You won!
</div>
<p><br></p>
<p>After a few minutes you receive this email to notify you of your winning.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image125.PNG"
     alt="">
    <br>
    Kringlecon 2 - Winner notification.
</div>
<p><br></p>
<h4 id="objective-8-solution">Objective 8 - Solution<a class="headerlink" href="#objective-8-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>8Ia8LiZEwvyZr2WO
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-9-retrieve-scraps-of-paper-from-server">Objective 9 - Retrieve Scraps of Paper from Server<a class="headerlink" href="#objective-9-retrieve-scraps-of-paper-from-server" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"If you need answer, talk to a rubber duck!" -kaknowles</td>
</tr>
<tr>
<td>Objective</td>
<td>Gain access to the data on the Student Portal server and retrieve the paper scraps hosted there. What is the name of Santa's cutting-edge sleigh guidance system? For hints on achieving this objective, please visit the dorm and talk with Pepper Minstix.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>4</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://studentportal.elfu.org/">Student Portal</a></td>
</tr>
<tr>
<td>Related Video</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="graylog-terminal-challenge">Graylog - Terminal Challenge<a class="headerlink" href="#graylog-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Pepper Minstix</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="http://docs.graylog.org/en/3.1/pages/queries.html">Graylog Docs</a>, (Events and Sysmon)</td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://pen-testing.sans.org/blog/2017/10/13/sqlmap-tamper-scripts-for-the-win">Sqlmap Tamper Scripts</a>, <a href="https://www.owasp.org/index.php/SQL_Injection">SQL Injection from OWASP</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image126.PNG"
     alt="">
    <br>
    Kringlecon 2 - Graylog - Terminal Challenge
</div>
<p><br>  </p>
<p>You read the Graylog Docs. You start the terminal challenge and login with credential <code>elfustudent/elfustudent</code>. You use various search parameters to find the answers to the questions.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image127.PNG"
     alt="">
    <br>
    Kringlecon 2 - Graylog Incident Response Report - Terminal Challenge
</div>
<p><br>  </p>
<h4 id="graylog-solution">Graylog - Solution<a class="headerlink" href="#graylog-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>ElfU Graylog Incident Response Report
Graylog Login:
elfustudent/elfustudent.

Question 1:
Minty CandyCane reported some weird activity on his computer after he clicked on a link in Firefox for a cookie recipe and downloaded a file.
What is the full-path + filename of the first malicious file downloaded by Minty?
Answer: C:\Users\minty\Downloads\cookie_recipe.exe
Hint: We can find this searching for sysmon file creation event id 2 with a process named firefox.exe and not junk .temp files. We can use regular expressions to include or exclude patterns:

TargetFilename:/.+\.pdf/

Question 2:
The malicious file downloaded and executed by Minty gave the attacker remote access to his machine. What was the ip:port the malicious file connected to first?
Answer: 192.168.247.175:4444
Hint: We can pivot off the answer to our first question using the binary path as our ProcessImage

Question 3:
What was the first command executed by the attacker? (answer is a single word)
Answer: C:\Windows\system32\cmd.exe /c &quot;whoami &quot;
Hint: Since all commands (sysmon event id 1) by the attacker are initially running through the cookie_recipe.exe binary, we can set its full-path as our ParentProcessImage to find child processes it creates sorting on timestamp.
Search: &quot;ParentProcessCommandLine:/.*cookie_recipe.*/&quot;

Question 4:
What is the one-word service name the attacker used to escalate privileges?
Answer: webexservice
Hint: Continuing on using the cookie_reciper.exe binary as our ParentProcessImage, we should see some more commands later on related to a service.

Question 5:
What is the file-path + filename of the binary ran by the attacker to dump credentials?
Answer: C:\cookie.exe
Hint: The attacker elevates privileges using the vulnerable webexservice to run a file called cookie_recipe2.exe. Let&#39;s use this binary path in our ParentProcessImage search.

Question 6:
The attacker pivoted to another workstation using credentials gained from Minty&#39;s computer. Which account name was used to pivot to another machine?
Answer: alabaster
Hint:Windows Event Id 4624 is generated when a user network logon occurs successfully. We can also filter on the attacker&#39;s IP using SourceNetworkAddress.
Search: EventID:4624 AND SourceNetworkAddress:192.168.247.175

Question 7:
What is the time ( HH:MM:SS ) the attacker makes a Remote Desktop connection to another machine?
Answer
Answer: 06:04:28
Hint: LogonType 10 is used for successful network connections using the RDP client.
Search: EventID:4624 AND SourceNetworkAddress:192.168.247.175

Question 8:
The attacker navigates the file system of a third host using their Remote Desktop Connection to the second host. What is the SourceHostName,DestinationHostname,LogonType of this connection? (submit in that order as csv)
Answer: ELFU-RES-WKS2,elfu-res-wks3,3
Search: ventID:4624 AND SourceHostName:ELFU\-RES\-WKS2
Hint:The attacker has GUI access to workstation 2 via RDP. They likely use this GUI connection to access the file system of of workstation 3 using explorer.exe via UNC file paths (which is why we don&#39;t see any cmd.exe or powershell.exe process creates). However, we still see the successful network authentication for this with event id 4624 and logon type 3.

Question 9:
What is the full-path + filename of the secret research document after being transferred from the third host to the second host?
Answer: C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf
Hints:
Search EventID:2 AND source:elfu\-res\-wks2 AND NOT TargetFilename:/.+AppData.+/
We can look for sysmon file creation event id of 2 with a source of workstation 2. We can also use regex to filter out overly common file paths using something like:
AND NOT TargetFilename:/.+AppData.+/


Question 10:
What is the IPv4 address (as found in logs) the secret research document was exfiltrated to?
Answer: 104.22.3.84
Hint: We can look for the original document in CommandLine using regex.
When we do that, we see a long a long PowerShell command using Invoke-Webrequest to a remote URL of https://pastebin.com/post.php.
We can pivot off of this information to look for a sysmon network connection id of 3 with a source of elfu-res-wks2 and DestinationHostname of pastebin.com.
Search: pastebin.com
</code></pre></div></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image129.PNG"
     alt="">
    <br>
    Kringlecon 2 - Report Submission
</div>
<p><br>  </p>
<p>Message from Pepper Ministix after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image128.PNG"
     alt="">
    <br>
    Kringlecon 2 - Graylog Incident Response Report - Terminal Challenge
</div>
<p><br>  </p>
<h3 id="objective-9-walkthrough">Objective 9 - Walkthrough<a class="headerlink" href="#objective-9-walkthrough" title="Permanent link">&para;</a></h3>
<p>You read the hints that were provided from solving the last terminal challenge. You look at the student portal.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image130.PNG"
     alt="">
    <br>
    Kringlecon 2 - Check Application Status
</div>
<p><br>  </p>
<p>You try a simple SQL injection <code>'email@domain.com</code> to ese if the website is vulnerable to SQL injection.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image131.PNG"
     alt="">
    <br>
    Kringlecon 2 - SQL injection
</div>
<p><br>  </p>
<p>After reviewing the webpage you notice that the CSRF validaitor url is <code>https://studentportal.elfu.org/validator.php</code></p>
<p>You download SQLMAP. You use the following configs:</p>
<div class="highlight"><pre><span></span><code>url = https://studentportal.elfu.org/application-check.php?elfmail=test%40test.com&amp;token=
method = get
csrfToken = token
csrfUrl = https://studentportal.elfu.org/validator.php
csrfMethod = GET
verbose = 6
</code></pre></div>
<p>You run SQLMAP with -dump. You get an error message that it's unable to find the CSRF token.</p>
<p>You search github to see where this error is coming from. You notice this error is coming from <code>connect.py</code> file around line 1110.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image137.PNG"
     alt="">
    <br>
    Kringlecon 2 - Interesting table
</div>
<p><br>  </p>
<p>You review the code and add 3 lines to "FIX" the code.</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;page:&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">page</span><span class="p">))</span>
<span class="n">token</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;token&quot;</span>
<span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="s2">&quot;%3D&quot;</span><span class="p">)</span>
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image136.PNG"
     alt="">
    <br>
    Kringlecon 2 - connect.py "FIX"
</div>
<p><br>  </p>
<p>You re-run SQLMAP with -dump.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image134.PNG"
     alt="">
    <br>
    Kringlecon 2 - SQLMAP Running.
</div>
<p><br>  </p>
<p>SQLMAP finds a database that has 6 image uids.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image135.PNG"
     alt="">
    <br>
    Kringlecon 2 - Interesting table
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image133.PNG"
     alt="">
    <br>
    Kringlecon 2 - SQLMAP completed.
</div>
<p><br>  </p>
<p>You download the 6 images that you found in the table.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\0f5f510e.png"
     alt="">
    <br>
    Kringlecon 2 - 0f5f510e.png
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\1cc7e121.png"
     alt="">
    <br>
    Kringlecon 2 - 1cc7e121.png
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\439f15e6.png"
     alt="">
    <br>
    Kringlecon 2 - 439f15e6.png
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\667d6896.png"
     alt="">
    <br>
    Kringlecon 2 - 667d6896.png
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\adb798ca.png"
     alt="">
    <br>
    Kringlecon 2 - adb798ca.png
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\ba417715.png"
     alt="">
    <br>
    Kringlecon 2 - ba417715.png
</div>
<p><br>  </p>
<p>You make out the name of Santa's cutting-edge sleigh guidance system on the edges of the scrapes.
<br></p>
<h4 id="objective-9-solution">Objective 9 - Solution<a class="headerlink" href="#objective-9-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Super sled-o-matic
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-10-recover-cleartext-document">Objective 10 - Recover Cleartext Document<a class="headerlink" href="#objective-10-recover-cleartext-document" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"Solve objectives to unravel the mystery <strike>of the universe</strike>." - Ed Skoudis</td>
</tr>
<tr>
<td>Objective</td>
<td>The Elfscrow Crypto tool is a vital asset used at Elf University for encrypting SUPER SECRET documents. We can't send you the source, but we do have debug symbols that you can use. Recover the plaintext content for this encrypted document. We know that it was encrypted on December 6, 2019, between 7pm and 9pm UTC. What is the middle line on the cover page? (Hint: it's five words) For hints on achieving this objective, please visit the NetWars room and talk with Holly Evergreen.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>5</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/elfscrow.exe">Elfscrow Crypto</a>, <a href="https://downloads.elfu.org/elfscrow.pdb">debug symbols</a>, <a href="https://downloads.elfu.org/ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc">encrypted document</a></td>
</tr>
<tr>
<td>Related Video</td>
<td><a href="https://www.youtube.com/watch?v=obJdpKDpFBA&amp;list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">Ron Bowes, Reversing Crypto the Easy Way</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="mongo-pilfer-terminal-challenge">Mongo Pilfer - Terminal Challenge<a class="headerlink" href="#mongo-pilfer-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Holly Evergreen</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="https://docs.mongodb.com/manual/reference/command/listDatabases/#dbcmd.listDatabases">MongoDB Documentation</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://youtu.be/obJdpKDpFBA">Reversing Crypto the Easy Way</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image138.PNG"
     alt="">
    <br>
    Kringlecon 2 - Holy Evergreen - Terminal Challenge
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image139.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<p>You read the hint provided by Holly Evergreen. You open the Mongo Pilfer terminal.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image140.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<p>You run <code>mongo</code> and receive this error message.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image141.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<p>You notice Mongo is not running on a default port.</p>
<p>You look around and find a file in the root <code>go.sh</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image142.PNG"
     alt="">
    <br>
    Kringlecon 2 - cat /go.sh
</div>
<p><br>  </p>
<p>This file shows that mongo is running on port 12121.</p>
<p>You run <code>mongo localhost:12121</code> to connect to the mongo server.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image143.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<p>You run <code>show dbs</code> to get a list of databases. You switch to <code>elfu</code> database. You list the collections <code>show collections</code>.</p>
<p>You run the action <code>find</code> on collection <code>solution</code>.</p>
<p>You run the command that is displayed from the above command.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image144.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image145.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<h4 id="mongo-pilfer-solution">Mongo Pilfer - Solution<a class="headerlink" href="#mongo-pilfer-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>mongo localhost:12121
db.loadServerScripts();displaySolution();
</code></pre></div></p>
<p>Message from Holly Evergreen after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image146.PNG"
     alt="">
    <br>
    Kringlecon 2 - Mongo Pilfer - Terminal Challenge
</div>
<p><br>  </p>
<h3 id="objective-10-walkthrough">Objective 10 - Walkthrough<a class="headerlink" href="#objective-10-walkthrough" title="Permanent link">&para;</a></h3>
<p>You watch the Reversing Crypto the Easy Way.</p>
<p>You run <code>elfscrow.exe</code> in a sandbox and encrypt a test document. You notice each time the document is encrypted it is providing a different escrow key.</p>
<p>You start by downloading and installing the free version of IDA. You download the symbols provided in the challenge. You open <code>elfscrow.exe</code> in IDA and load the symbols.</p>
<p>You navigate to <code>generate_key</code> function. You notice the function is calling the time. After the time function has been called it's calling the <code>super_secure_srand</code> function.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image147.PNG"
     alt="">
    <br>
    Kringlecon 2 - Ida Generate_key function
</div>
<p><br>  </p>
<p>You google the time function and notice that it returns the time in epoch.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image148.PNG"
     alt="">
    <br>
    Kringlecon 2 - time function
</div>
<p><br>  </p>
<p>You write a python program to output time in epoch.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Seed =&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>You run <code>elfscrow.exe</code> at the same time as the python script and confirm that <code>elfscrow.exe</code> is using is time() as the Seed.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image165.PNG"
     alt="">
    <br>
    Kringlecon 2 - Elfscrow.exe
</div>
<p><br>  </p>
<p>From earlier, you know this seed is likely passed to <code>super_secure_srand</code> function.
You review <code>super_secure_srand</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image149.PNG"
     alt="">
    <br>
    Kringlecon 2 - super_secure_srand function
</div>
<p><br>  </p>
<p>You see a few constant in this function, ex. <code>2531011</code>.</p>
<p>You search Google for this constant. You find a Fastrand() function that uses the same constants.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image150.PNG"
     alt="">
    <br>
    Kringlecon 2 - Fastrand()
</div>
<p><br>  </p>
<p>You remember the video talked about how to create a generate_key function.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image151.PNG"
     alt="">
    <br>
    Kringlecon 2 - Screenshot from the talk
</div>
<p><br><br />
Using the video as a guide, you write the generate_key() function.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">seed</span><span class="o">=</span><span class="p">(</span><span class="mi">214013</span><span class="o">*</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">2531011</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">+=</span>  <span class="nb">chr</span><span class="p">(((</span><span class="n">seed</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7fff</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x0ff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key</span>
</code></pre></div>
<p>While reviewing the code, you find that the encryption is likely DES-CBC.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image154.PNG"
     alt="">
    <br>
    Kringlecon 2 - DES-CBC key
</div>
<p><br>  </p>
<p>You test decrypting the file you encrypted on <a href="https://gchq.github.io/CyberChef/">CyberChef</a>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image155.PNG"
     alt="">
    <br>
    Kringlecon 2 - Decrypt the file encrypted by elfscrow.exe
</div>
<p><br>  </p>
<p>The objective states the file was encrypted on December 6, 2019, between 7pm and 9pm UTC. You convert the time to epoch time.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image159.PNG"
     alt="">
    <br>
    Kringlecon 2 - epoch time December 6, 2019, 7 PM

</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image160.PNG"
     alt="">
    <br>
    Kringlecon 2 - epoch time December 6, 2019, 9 PM
</div>
<p><br></p>
<p>You know the key is between 1575658800 and 1575666000.
You write a For loop around generate_key() function to generate all the keys. You output all the keys to a <code>keys.txt</code>.</p>
<p>You download <a href="https://github.com/gchq/CyberChef/wiki/Node-API">CyberChef API</a> from github.</p>
<p>You write a wrapper in Javascript to open <code>keys.txt</code> and decrypt it using CyberChef framework. You use the DES-CBC to decrypt the <code>ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc</code> with all possible keys. You output the decrypted files to a folder with the key that was used to decrypt it as the filename.</p>
<p>{% highlight JavaScript linenos %}
// app.js
const chef = require("cyberchef");
var readline = require('readline');
const fs = require('fs');</p>
<p>let file = fs.readFileSync("ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc");
console.log(file) ;</p>
<p>var myInterface = readline.createInterface({
  input: fs.createReadStream('keys.txt')
});</p>
<p>var lineno = 0;
myInterface.on('line', function (line) {
  lineno++;
  console.log('Line number ' + lineno + ': ' + line.trim());</p>
<div class="highlight"><pre><span></span><code>try {
  var results = chef.DESDecrypt(file,{
            Key:{string:line.trim(), option:&quot;Hex&quot;},
            IV:{string:&quot;0000000000000000&quot;, option:&quot;Hex&quot;},
            Mode: &quot;CBC&quot;,
            Input:&quot;Raw&quot;,
            Output:&quot;Raw&quot;},).toString();
  //  console.log(results);

  fs.writeFileSync(&#39;./files/&#39;.concat(line.trim()), results, &quot;binary&quot;,(err) =&gt; {
      // throws an error, you could also catch it here
      if (err) throw err;

      // success case, the file was saved
      console.log(&#39;Lyric saved!&#39;);
  });

  results = &#39;&#39;


        }
catch(err) {
}
</code></pre></div>
<p>});</p>
<p>{% endhighlight JavaScript %}</p>
<p>You run the JavaScript file and wait until it has decrypted the file with all possible keys.</p>
<p>Once completed, you run the command <code>grep -rl "%PDF"</code> to find the decrypted file that has a PDF header.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image161.PNG"
     alt="">
    <br>
    Kringlecon 2 - The only decrypted file with the "%PDF" header
</div>
<p><br></p>
<p>The key used to encrypt the file is <code>b5ad6a321240fbec</code>.</p>
<p>You open the decrypted file.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image163.PNG"
     alt="">
    <br>
    Kringlecon 2 - Document decrypted
</div>
<p><br></p>
<p>You notice an interesting section in the file that may come handy later.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image166.PNG"
     alt="">
    <br>
    Kringlecon 2 - Document decrypted
</div>
<p><br></p>
<h4 id="objective-10-solution">Objective 10 - Solution<a class="headerlink" href="#objective-10-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Machine Learning Sleigh Route Finder
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-11-open-the-sleigh-shop-door">Objective 11 - Open the Sleigh Shop Door<a class="headerlink" href="#objective-11-open-the-sleigh-shop-door" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"You must learn to say 'no'" -hacks4pancake</td>
</tr>
<tr>
<td>Objective</td>
<td>Visit Shinny Upatree in the Student Union and help solve their problem. What is written on the paper you retrieve for Shinny? For hints on achieving this objective, please visit the Student Union and talk with Kent Tinseltooth.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>5</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://crate.elfu.org/">Crate</a></td>
</tr>
<tr>
<td>Related Video</td>
<td></td>
</tr>
<tr>
<td><br></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="smart-braces-terminal-challenge">Smart Braces - Terminal Challenge<a class="headerlink" href="#smart-braces-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Kent Tinseltooth</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="https://upcloud.com/community/tutorials/configure-iptables-centos/">Iptables</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td><a href="https://developers.google.com/web/tools/chrome-devtools">Chrome Dev Tools</a></td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image167.PNG"
     alt="">
    <br>
    Kringlecon 2 - Kent Tinseltooth - Terminal Challenge
</div>
<p><br>  </p>
<p>You open the console and see the following messages:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image168.PNG"
     alt="">
    <br>
    Kringlecon 2 - Smart Braces - Terminal Challenge
</div>
<p><br>  </p>
<p>You read IOTteethBraces.md.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image169.PNG"
     alt="">
    <br>
    Kringlecon 2 - IOTteethBraces.md
</div>
<p><br>  </p>
<p>This is a timed challenge. If you take too long to solve the challenge, you're greeted with the following message:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image170.PNG"
     alt="">
    <br>
    Kringlecon 2 - Kent Tinseltooth - Terminal Challenge
</div>
<p><br>  </p>
<p>You read the hint for this challenge and write the IP tables for the challenge.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image171.PNG"
     alt="">
    <br>
    Kringlecon 2 - Kent Tinseltooth - Terminal Challenge
</div>
<p><br>  </p>
<h4 id="smart-braces-solution">Smart Braces - Solution<a class="headerlink" href="#smart-braces-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>sudo iptables -F
sudo iptables -P FORWARD DROP
sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A OUTPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

sudo iptables -A INPUT -p tcp -s 172.19.0.255 --dport 22 -j ACCEPT
sudo iptables -A INPUT -p tcp --match multiport --dport 21,80 -j ACCEPT
sudo iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -i lo -j ACCEPT
</code></pre></div></p>
<p>Message from Kent Tinseltooth after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image172.PNG"
     alt="">
    <br>
    Kringlecon 2 - Kent Tinseltooth - Terminal Challenge
</div>
<p><br>  </p>
<h3 id="objective-11-walkthrough">Objective 11 - Walkthrough<a class="headerlink" href="#objective-11-walkthrough" title="Permanent link">&para;</a></h3>
<p>You visit Shinny Upatree and are greeted with this message:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image173.PNG"
     alt="">
    <br>
    Kringlecon 2 - Shinny Upatree
</div>
<p><br>  </p>
<p>When you visit <a href="https://crate.elfu.org/">crate</a> website, you're greeted with a number of locks that you have to open. Each lock provides hint(s) for opening the lock.
<br></p>
<h4 id="lock-1">Lock 1<a class="headerlink" href="#lock-1" title="Permanent link">&para;</a></h4>
<p>You open the chrome developer tools and see a code <code>62ID5140</code>. You type this code in lock 1 and it unlocks.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image174.PNG"
     alt="">
    <br>
    Kringlecon 2 - Lock 1
</div>
<p><br>  </p>
<h4 id="lock-2">Lock 2<a class="headerlink" href="#lock-2" title="Permanent link">&para;</a></h4>
<p>You proceed to lock 2.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image175.PNG"
     alt="">
    <br>
    Kringlecon 2 - Lock 2
</div>
<p><br>  </p>
<p>You view the source code for lock 2 and see the code <code>5U7A9BBX</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image177.PNG"
     alt="">
    <br>
    Kringlecon 2 - Lock 2 Source Code
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image176.PNG"
     alt="">
    <br>
    Kringlecon 2 - Lock 2 - Print Preview
</div>
<p><br>  </p>
<h4 id="lock-3">Lock 3<a class="headerlink" href="#lock-3" title="Permanent link">&para;</a></h4>
<p>You proceed to lock 3.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image178.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 3
</div>
<p><br>  </p>
<p>You view the Network response in chrome developer tools.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image179.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 3 - Network response
</div>
<p><br>  </p>
<p>You load the <code>.png</code> file that you see in network response.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image180.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 3 - png
</div>
<p><br>  </p>
<p>You type the code in lock 3 to unlock it.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image181.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 3 - Solved
</div>
<p><br>  </p>
<h4 id="lock-4">Lock 4<a class="headerlink" href="#lock-4" title="Permanent link">&para;</a></h4>
<p>You proceed to lock 4.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image182.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 4
</div>
<p><br>  </p>
<p>You go to <code>Application</code> tab in chrome developer tools and expand <code>Local Stroage</code> under <code>Storage</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image183.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 4 - Local Storage
</div>
<p><br>  </p>
<p>You type the code to unlock lock 4.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image184.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 4 - Solved
</div>
<p><br>  </p>
<h4 id="lock-5">Lock 5<a class="headerlink" href="#lock-5" title="Permanent link">&para;</a></h4>
<p>You proceed to Lock 5.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image185.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 5
</div>
<p><br>  </p>
<p>The hint says to view the title on the html page. You view the title.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image186.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 5 - html
</div>
<p><br>  </p>
<p>You type the code in lock 5 to unlock it.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image187.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 5 - Solved
</div>
<p><br>  </p>
<h4 id="lock-6">Lock 6<a class="headerlink" href="#lock-6" title="Permanent link">&para;</a></h4>
<p>You proceed to Lock 6.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image188.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 6
</div>
<p><br>  </p>
<p>You view the .css file and update the <code>perspective</code> variable.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image190.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 6 - .css
</div>
<p><br>  </p>
<p>The code becomes visible.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image191.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 6 - .css
</div>
<p><br>  </p>
<p>You type the code in the lock.
<br></p>
<h4 id="lock-7">Lock 7<a class="headerlink" href="#lock-7" title="Permanent link">&para;</a></h4>
<p>You proceed to Lock 7.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image192.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 7
</div>
<p><br>  </p>
<p>You view the <code>font-family</code> in the html file and see <code>QCIAX2SW</code></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image193.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 7 - font-family html
</div>
<p><br>  </p>
<p>You type the code to unlock lock 7.
<br></p>
<h4 id="lock-8">Lock 8<a class="headerlink" href="#lock-8" title="Permanent link">&para;</a></h4>
<p>You proceed to Lock 8</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image194.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 8
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image195.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 8 - Code analysiss
</div>
<p><br>  </p>
<p>You create a button <code>.egg</code> and get the event listener.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image197.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 8 - Event Listener
</div>
<p><br>  </p>
<p>You enter <code>VERONICA</code> into the lock to unlock it.
<br></p>
<h4 id="lock-9">Lock 9<a class="headerlink" href="#lock-9" title="Permanent link">&para;</a></h4>
<p>You proceed to lock 9.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image198.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 9
</div>
<p><br>  </p>
<p>You set the chakra's in the code to active. You see that the code appears above the instructions.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image199.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 9
</div>
<p><br>  </p>
<p>You type the code into the lock to unlock.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image200.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 9 - Solved
</div>
<p><br>  </p>
<h4 id="lock-10">Lock 10<a class="headerlink" href="#lock-10" title="Permanent link">&para;</a></h4>
<p>You proceed to lock 10.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image201.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10
</div>
<p><br>  </p>
<p>You view the code for the lock.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image202.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - Code
</div>
<p><br>  </p>
<p>You remove the <code>"cover"</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image203.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - Remove Cover
</div>
<p><br>  </p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image204.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10
</div>
<p><br>  </p>
<p>When you try to type a code the lock, an error appears in the console that it's missing a macaroni. You search the code for macaroni and find this.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image205.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - macaroni
</div>
<p><br>  </p>
<p>You look at the .css and find that there is a mac.png, qtip.png and gnome.png.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image206.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - png, qtip.png and gnome.png
</div>
<p><br>  </p>
<p>You look for gnome in the code.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image207.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - gnome
</div>
<p><br>  </p>
<p>You find swab in the code.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image208.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - swab/qtip
</div>
<p><br></p>
<p>You copy the three components to the lock 10 code.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image209.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - Fix circuit board
</div>
<p><br></p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image210.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - Fixed lock
</div>
<p><br></p>
<p>You zoom into the side of the circuit board to find the code to unlock the lock <code>K029XJ37</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image213.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - code
</div>
<p><br></p>
<p>You're greeted by this message once you unlock lock 10.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image214.PNG"  
     alt="">
    <br>
    Kringlecon 2 - Lock 10 - code
</div>
<p><br></p>
<h4 id="objective-11-solution">Objective 11 - Solution<a class="headerlink" href="#objective-11-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Lock 1: 62ID5140
Lock 2: 5U7A9BBX
Lock 3: FZUNIJFD
Lock 4: H0UHDN8S
Lock 5: ZW5698HD
Lock 6: SRB40Q5Q
Lock 7: QCIAX2SW
Lock 8: VERONICA
Lock 9: 0QIMRKYC
Lock 10: K029XJ37

The villian is The Tooth Fairy.
</code></pre></div></p>
<hr />
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="objective-12-filter-out-poisoned-sources-of-weather-data">Objective 12 - Filter Out Poisoned Sources of Weather Data<a class="headerlink" href="#objective-12-filter-out-poisoned-sources-of-weather-data" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inspirational Quote</td>
<td>"A Nerarious, villainous, Evil attacker is the worst of attacker you can have." -Ed Skoudis</td>
</tr>
<tr>
<td>Objective</td>
<td>Use the data supplied in the Zeek JSON logs to identify the IP addresses of attackers poisoning Santa's flight mapping software. Block the 100 offending sources of information to guide Santa's sleigh through the attack. Submit the Route ID ("RID") success value that you're given. For hints on achieving this objective, please visit the Sleigh Shop and talk with Wunorse Openslae.</td>
</tr>
<tr>
<td>Difficulty Level:</td>
<td>4</td>
</tr>
<tr>
<td>Links</td>
<td><a href="https://downloads.elfu.org/http.log.gz">Zeek JSON logs</a>, <a href="https://srf.elfu.org/">Block the 100 offending sources of information to guide Santa's sleigh</a></td>
</tr>
<tr>
<td>Related Video</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="zeek-json-analysis-terminal-challenge">Zeek JSON Analysis - Terminal Challenge<a class="headerlink" href="#zeek-json-analysis-terminal-challenge" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Elf Name</td>
<td>Wunorse Openslae</td>
</tr>
<tr>
<td>Pre-Solve Hints</td>
<td><a href="https://pen-testing.sans.org/blog/2019/12/03/parsing-zeek-json-logs-with-jq-2">Parsing Zeek JSON Logs with JQ</a></td>
</tr>
<tr>
<td>Post-Solve Hints</td>
<td>Do you see any <a href="https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion">LFI</a>, <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">XSS</a>, <a href="https://en.wikipedia.org/wiki/Shellshock_(software_bug)">Shellshock</a>, or <a href="https://www.owasp.org/index.php/SQL_Injection">SQLi</a>?</td>
</tr>
<tr>
<td>Objective</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image215.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<p>You read the instructions for jq. You open the terminal console.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image216.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<p>You use jq to find the longest durations.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image217.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<p>You modify the query to display the host and destinations.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image218.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<p>You modify the query to sort by duration and get the last item of the list.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image219.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<p>You run the <code>runtoanswer</code> and type in <code>13.107.21.200</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image220.PNG"
     alt="">
    <br>
    Kringlecon 2 - Zeek JSON Analysis - Terminal Challenge
</div>
<p><br>  </p>
<h4 id="zeek-json-analysis-solution">Zeek JSON Analysis - Solution<a class="headerlink" href="#zeek-json-analysis-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>13.107.21.200
</code></pre></div></p>
<p>Message from Wunorse Openslae after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image222.PNG"
     alt="">
    <br>
    Kringlecon 2 - Wunorse Openslae - Terminal Challenge
</div>
<p><br>  </p>
<p><br></p>
<h3 id="objective-12-walkthrough">Objective 12 - Walkthrough<a class="headerlink" href="#objective-12-walkthrough" title="Permanent link">&para;</a></h3>
<p>You download zeek logs. We need to find the credentials to login to the website.</p>
<p>You use JQ to filter out the noise and view successful connections.</p>
<div class="highlight"><pre><span></span><code>jq &#39;.[] | select (.uri | contains (&quot;weather?station&quot;) | not) | select (.status_code == 200) | .uri&#39; http.log | sort |uniq
</code></pre></div>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image223.PNG"
     alt="">
    <br>
    Kringlecon 2 - Filter out the noise using JQ
</div>
<p><br>  </p>
<p>You see a file name <code>README.md</code>. You remember the document you decrypted in an earlier challenge, referred to default credentials being stored in <code>README.md</code>.</p>
<p>You access <code>srf.elfu.org/README.md</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image224.PNG"
     alt="">
    <br>
    Kringlecon 2 - README.md
</div>
<p><br>  </p>
<p>You login <code>srf.elfu.org</code> with the default login.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image225.PNG"
     alt="">
    <br>
    Kringlecon 2 - srf login page
</div>
<p><br>  </p>
<p>The welcome page once you login to <code>srf</code>.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image226.PNG"
     alt="">
    <br>
    Kringlecon 2 - srf welcome page
</div>
<p><br>  </p>
<p>You review the Firewall instructions on how to block and allow IPs.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image227.PNG"
     alt="">
    <br>
    Kringlecon 2 - Firewall Instructions
</div>
<p><br>  </p>
<p>You use JQ and the hints to find some of the bad IPs:
<div class="highlight"><pre><span></span><code>jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host , &quot;\n&quot;&#39; http.log | grep -E \&#39; &gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | awk  &#39;/\/\.\./&#39; &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep -E &quot;\.\.&quot; &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep -E \/\.\% &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep pass &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep \&gt; &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep \&amp; &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | grep \| &gt;&gt; blah.csv
jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | awk &#39;/\;\s*\}/&#39; &gt;&gt; blah.csv
</code></pre></div></p>
<p>From the above queries you get 78 Bad IPs. You know there is about 100 bad IPs. You export all the events to a .csv file.
<div class="highlight"><pre><span></span><code>jq -j &#39;.[] |  .[&quot;id.orig_h&quot;], &quot;, &quot;,.[&quot;user_agent&quot;],&quot;, &quot;, .uri, &quot;, &quot;,.username, &quot;, &quot;,.password, &quot;, &quot;,.host,  &quot;\n&quot;&#39; http.log | &gt; all.csv
</code></pre></div></p>
<p>You open <code>all.csv</code> in excel and look at the data.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image230.PNG"
     alt="">
    <br>
    Kringlecon 2 - Pivot table on the User-Agent
</div>
<p><br>  </p>
<p>You use vlookup to get the user-agent count for each of the IP's user-agents. You filter on user-agent count that are low.
You filter out the IPs that are already in your bad IP list.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image231.PNG"
     alt="">
    <br>
    Kringlecon 2 - Filter by user-agents that have low hits.
</div>
<p><br>  </p>
<p>You get about 39 new IPs.</p>
<div class="highlight"><pre><span></span><code>103.235.93.133
118.26.57.38
44.164.136.41
249.237.77.152
203.68.29.5
10.122.158.57
187.152.203.243
50.154.111.0
217.132.156.225
252.122.243.212
29.0.183.220
22.34.153.164
66.116.147.181
126.102.12.53
31.116.232.143
250.22.86.40
140.60.154.239
226.102.56.13
42.127.244.30
104.179.109.113
42.103.246.130
42.103.246.130
42.103.246.130
42.103.246.130
185.19.7.133
42.16.149.112
158.171.84.209
34.155.174.167
249.90.116.138
231.179.108.238
92.213.148.0
97.220.93.190
87.195.80.126
53.160.218.44
253.65.40.39
226.240.188.154
148.146.134.52
142.128.135.10
37.216.249.50
</code></pre></div>
<p>You combine the bad IPs. Here is a list of bad IPs:</p>
<div class="highlight"><pre><span></span><code>42.103.246.250,49.161.8.58,84.147.231.129,2.230.60.70,10.155.246.29,225.191.220.138,75.73.228.192,249.34.9.16,27.88.56.114,238.143.78.114,121.7.186.163,106.132.195.153,129.121.121.48,190.245.228.38,34.129.179.28,135.32.99.116,2.240.116.254,45.239.232.245,33.132.98.193,84.185.44.166,254.140.181.172,150.50.77.238,68.115.251.76,118.196.230.170,173.37.160.150,81.14.204.154,135.203.243.43,186.28.46.179,13.39.153.254,111.81.145.191,0.216.249.31,220.132.33.81,83.0.8.119,150.45.133.97,229.229.189.246,227.110.45.126,123.127.233.97,80.244.147.207,200.75.228.240,230.246.50.221,223.149.180.133,187.178.169.123,116.116.98.205,102.143.16.184,52.39.201.107,131.186.145.73,253.182.102.55,1.185.21.112,229.133.163.235,194.143.151.224,23.49.177.78,75.215.214.65,211.229.3.254,250.51.219.47,180.57.20.247,9.206.212.33,79.198.89.109,25.80.197.172,193.228.194.36,169.242.54.5,28.169.41.122,233.74.78.199,132.45.187.177,56.5.47.137,19.235.69.221,69.221.145.150,42.191.112.181,48.66.193.176,44.74.106.131,106.93.213.219,31.254.228.4,61.110.82.125,65.153.114.120,95.166.116.45,168.66.108.62,139.45.221.220,96.156.113.98,170.51.98.223,103.235.93.133,118.26.57.38,44.164.136.41,249.237.77.152,203.68.29.5,10.122.158.57,187.152.203.243,50.154.111.0,217.132.156.225,252.122.243.212,29.0.183.220,22.34.153.164,66.116.147.181,126.102.12.53,31.116.232.143,250.22.86.40,140.60.154.239,226.102.56.13,42.127.244.30,104.179.109.113,42.103.246.130,185.19.7.133,42.16.149.112,158.171.84.209,34.155.174.167,249.90.116.138,231.179.108.238,92.213.148.0,97.220.93.190,87.195.80.126,53.160.218.44,253.65.40.39,226.240.188.154,148.146.134.52,142.128.135.10,37.216.249.50
</code></pre></div>
<p>You block the IPs on the firewall.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image228.PNG"
     alt="">
    <br>
    Kringlecon 2 - Block bad IPs in firewall
</div>
<p><br><br />
<br></p>
<h4 id="objective-12-solution">Objective 12 - Solution<a class="headerlink" href="#objective-12-solution" title="Permanent link">&para;</a></h4>
<p>Answer:
<div class="highlight"><pre><span></span><code>Route Calculation Success! RID:0807198508261964
</code></pre></div></p>
<p>Message from Tooth Fairy after solving the challenge:</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image229.PNG"
     alt="">
    <br>
    Kringlecon 2 - Tooth Fairy response
</div>
<p><br>  </p>
<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>
<p><br></p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Once you solve the challenge, the bell tower door opens up.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image230-1.PNG"
     alt="">
    <br>
    Kringlecon 2 - Bell Tower Access
</div>
<p><br>  </p>
<p>You go up the ladder to the bell tower.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image231-1.PNG"
     alt="">
    <br>
    Kringlecon 2 - Bell Tower Access
</div>
<p><br>  </p>
<p>You open the letter in the corner of the room.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image232.PNG"
     alt="">
    <br>
    Kringlecon 2 - Bell Tower
</div>
<p><br>  </p>
<p>You talk to Santa.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image233.PNG"
     alt="">
    <br>
    Kringlecon 2 - Santa
</div>
<p><br>  </p>
<p>You talk to Tooth Fairy.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image234.PNG"
     alt="">
    <br>
    Kringlecon 2 - Tooth Fairy
</div>
<p><br>  </p>
<p>You talk to Krampus.</p>
<div style="text-align:center">
    <br>
     <img src="\assets\images\2020-01-10-KringleCon2\Image235.PNG"
     alt="">
    <br>
    Kringlecon 2 - Krampus
</div>
<p><br>  </p>
<p>The narrative of the story line:</p>
<div class="highlight"><pre><span></span><code>Whose grounds these are, I think I know

His home is in the North Pole though

He will not mind me traipsing here

To watch his students learn and grow

Some other folk might stop and sneer

&quot;Two turtle doves, this man did rear?&quot;

I&#39;ll find the birds, come push or shove

Objectives given: I&#39;ll soon clear

Upon discov&#39;ring each white dove,

The subject of much campus love,

I find the challenges are more

Than one can count on woolen glove.

Who wandered thus through closet door?

Ho ho, what&#39;s this? What strange boudoir!

Things here cannot be what they seem

That portal&#39;s more than clothing store.

Who enters contests by the ream

And lives in tunnels meant for steam?

This Krampus bloke seems rather strange

And yet I must now join his team...

Despite this fellow&#39;s funk and mange

My fate, I think, he&#39;s bound to change.

What is this contest all about?

His victory I shall arrange!

To arms, my friends! Do scream and shout!

Some villain targets Santa&#39;s route!

What scum - what filth would seek to end

Kris Kringle&#39;s journey while he&#39;s out?

Surprised, I am, but &quot;shock&quot; may tend

To overstate and condescend.

&#39;Tis little more than plot reveal

That fairies often do extend

And yet, despite her jealous zeal,

My skills did win, my hacking heal!

No dental dealer can so keep

Our red-clad hero in ordeal!

This Christmas must now fall asleep,

But next year comes, and troubles creep.

And Jack Frost hasn&#39;t made a peep,

And Jack Frost hasn&#39;t made a peep...
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../../2021/post1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Migrating Blog from Jekyll to MkDocs on GitHub pages" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Migrating Blog from Jekyll to MkDocs on GitHub pages
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../2019/post3/2019-06-16-HowToDeobfuscateJS/" class="md-footer__link md-footer__link--next" aria-label="Next: How to Deobfuscate JavaScript" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              How to Deobfuscate JavaScript
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>
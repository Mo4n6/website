
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../images/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>9) Splunk! - Kringlecon 4 - Calling Birds!</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#e92063">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="pink" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Kringlecon 4 - Calling Birds!" class="md-header__button md-logo" aria-label="Kringlecon 4 - Calling Birds!" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kringlecon 4 - Calling Birds!
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              9) Splunk!
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Kringlecon 4 - Calling Birds!" class="md-nav__button md-logo" aria-label="Kringlecon 4 - Calling Birds!" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    Kringlecon 4 - Calling Birds!
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.sharif.org" class="md-nav__link">
        Back to sharif.org
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Objectives
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Objectives" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Objectives
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective1/" class="md-nav__link">
        1) KringleCon Orientation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective2/" class="md-nav__link">
        2) Where in the World is Caramel Santaigo?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective3/" class="md-nav__link">
        3) Thaw Frost Tower's Entrance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective4/" class="md-nav__link">
        4) Slot Machine Investigation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective5/" class="md-nav__link">
        5) Strange USB Device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective6/" class="md-nav__link">
        6) Shellcode Primer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective7/" class="md-nav__link">
        7) Printer Exploitation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective8/" class="md-nav__link">
        8) Kerberoasting on an Open Fire
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        9) Splunk!
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective10/" class="md-nav__link">
        10) Now Hiring!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective11/" class="md-nav__link">
        11) Customer Complaint Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective12/" class="md-nav__link">
        12) Frost Tower Website Checkup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Objective13/" class="md-nav__link">
        13) FPGA Programming
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Terminals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Terminals" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Terminals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal1/" class="md-nav__link">
        Cranberry Pi Terminal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal2/" class="md-nav__link">
        Exif Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal3/" class="md-nav__link">
        Grepping for Gold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal4/" class="md-nav__link">
        Logic Muchers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal5/" class="md-nav__link">
        IPv6 Sandbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal6/" class="md-nav__link">
        Holiday Hero
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal7/" class="md-nav__link">
        Shellcode Primer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal8/" class="md-nav__link">
        HoHo … No
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal9/" class="md-nav__link">
        Yara Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal10/" class="md-nav__link">
        IMDS Exploration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal11/" class="md-nav__link">
        Strace Ltrace Retrace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal12/" class="md-nav__link">
        Elf Code Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal13/" class="md-nav__link">
        Frostavator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal14/" class="md-nav__link">
        Bonus! Blue Log4Jack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Terminals/Terminal15/" class="md-nav__link">
        Bonus! Red Log4Jack
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../items/" class="md-nav__link">
        Items
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Hints
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hints" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Hints
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ohints/" class="md-nav__link">
        Objectives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../thints/" class="md-nav__link">
        Terminals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../map/" class="md-nav__link">
        Map
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../narrative/" class="md-nav__link">
        Narrative
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../music/" class="md-nav__link">
        Music
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../booths/" class="md-nav__link">
        Booths
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../credits/" class="md-nav__link">
        Credits
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../answers/" class="md-nav__link">
        Answers
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>9) Splunk!</h1>

<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Objective</label><label for="__tabbed_1_2">Walk-through</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="Obj" src="../../../images/obj/9/image1.png" /></p>
<div class="admonition info">
<p class="admonition-title">Details</p>
<ul>
<li><em>Location</em>: KringleCon/Great Room</li>
<li><em>Elf</em>: Angel Candysalt</li>
<li><em>Objective Link 1</em>: <a href="https://hhc21.bossworkshops.io/en-US/app/SA-hhc/santadocs">Link</a></li>
</ul>
</div>
<p><img alt="Obj" src="../../../images/obj/9/image2.png" /></p>
<div class="admonition quote">
<p class="admonition-title">Elf's Objective Message</p>
<p>Greetings North Pole visitor! I'm Angel Candysalt!
A euphemism? No, that's my name. Why do people ask me that?
Anywho, I'm back at Santa’s Splunk terminal again this year.
There's always more to learn!
Take a look and see what you can find this year.
With who-knows-what going on next door, it never hurts to have sharp SIEM skills!</p>
</div>
</div>
<div class="tabbed-block">
<p>The terminal challenge for this objective is the terminal "Yara Analysis" offered by Fitzy Shortstack. Solving this terminal challenge provides additional hints for this objective. To view the hints use the menu on the left.</p>
<p>To start this objective click on the "splunk&gt;" terminal next to Angel Candysalt. This challenge has 8 tasks that need to be completed. The walk-through for each task can be accessed bellow with the corresponding tab number.</p>
<div class="admonition tasks">
<p class="admonition-title">Tasks</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:8"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><input id="__tabbed_2_5" name="__tabbed_2" type="radio" /><input id="__tabbed_2_6" name="__tabbed_2" type="radio" /><input id="__tabbed_2_7" name="__tabbed_2" type="radio" /><input id="__tabbed_2_8" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">1</label><label for="__tabbed_2_2">2</label><label for="__tabbed_2_3">3</label><label for="__tabbed_2_4">4</label><label for="__tabbed_2_5">5</label><label for="__tabbed_2_6">6</label><label for="__tabbed_2_7">7</label><label for="__tabbed_2_8">8</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Task 1:
Capture the commands Eddie ran most often, starting with git. Looking only at his process launches as reported by Sysmon, record the most common git-related CommandLine that Eddie seemed to use.</p>
<p>Search for the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">user</span><span class="o">=</span><span class="n">eddie</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="o">|</span> <span class="n">stats</span> <span class="n">count</span> <span class="n">by</span> <span class="n">CommandLine</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span> <span class="n">count</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>git status</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 2:
Looking through the git commands Eddie ran, determine the remote repository that he configured as the origin for the 'partnerapi' repo. The correct one!</p>
<p>Search for the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">user</span><span class="o">=</span><span class="n">eddie</span> <span class="n">CommandLine</span><span class="o">=</span><span class="s2">&quot;*git remote add*&quot;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="o">|</span> <span class="n">stats</span> <span class="n">count</span> <span class="n">by</span> <span class="n">CommandLine</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span> <span class="n">count</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p><a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#105;&#116;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#103;&#105;&#116;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>:elfnp3/partnerapi.git</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 3:
The 'partnerapi' project that Eddie worked on uses Docker. Gather the full docker command line that Eddie used to start the 'partnerapi' project on his workstation.</p>
<p>Search for the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">user</span><span class="o">=</span><span class="n">eddie</span> <span class="n">CommandLine</span><span class="o">=</span><span class="s2">&quot;*docker*&quot;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="o">|</span> <span class="n">stats</span> <span class="n">count</span> <span class="n">by</span> <span class="n">CommandLine</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>    <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span> <span class="n">count</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>docker compose up</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 4:
Eddie had been testing automated static application security testing (SAST) in GitHub. Vulnerability reports have been coming into Splunk in JSON format via GitHub webhooks. Search all the events in the main index in Splunk and use the sourcetype field to locate these reports. Determine the URL of the vulnerable GitHub repository that the elves cloned for testing and document it here. You will need to search outside of Splunk (try GitHub) for the original name of the repository.</p>
<p>Search for the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">github_json</span> <span class="o">|</span> <span class="n">stats</span> <span class="n">count</span> <span class="n">by</span> <span class="s2">&quot;repository.clone_url&quot;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span> <span class="n">count</span>
</code></pre></div>
<p>Use the results and github commits to find the orignal repository name <code>https://github.com/elfnp3/dvws-node/commits</code>
<img alt="Obj" src="../../../images/obj/9/image3.png" /></p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p><a href="https://github.com/snoopysecurity/dvws-node">https://github.com/snoopysecurity/dvws-node</a></p>
</div>
</div>
<div class="tabbed-block">
<p>Task 5:
Santa asked Eddie to add a JavaScript library from NPM to the 'partnerapi' project. Determine the name of the library and record it here for our workshop documentation.</p>
<p>Search for the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">user</span><span class="o">=</span><span class="n">eddie</span> <span class="n">CommandLine</span><span class="o">=</span><span class="s2">&quot;*npm*&quot;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="o">|</span> <span class="n">stats</span> <span class="n">count</span> <span class="n">by</span> <span class="n">CommandLine</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span> <span class="n">count</span>
</code></pre></div>
<p>From the results you will see the command <code>node /usr/bin/npm install holiday-utils-js</code>.</p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>holiday-utils-js</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 6:
Another elf started gathering a baseline of the network activity that Eddie generated. Start with <a href="https://hhc21.bossworkshops.io/en-US/app/SA-hhc/search?q=search%20index%3Dmain%20sourcetype%3Djournald%20source%3DJournald%3AMicrosoft-Windows-Sysmon%2FOperational%20EventCode%3D3%20user%3Deddie%20NOT%20dest_ip%20IN%20(127.0.0.*)%20NOT%20dest_port%20IN%20(22%2C53%2C80%2C443)%20%0A%7C%20stats%20count%20by%20dest_ip%20dest_port&amp;display.page.search.mode=smart&amp;dispatch.sample_ratio=1&amp;workload_pool=&amp;earliest=0&amp;latest=now">their search</a> and capture the full process_name field of anything that looks suspicious.</p>
<p>The above search will return two IP addresses. Looking at the IP address <code>54.175.69.219</code> we see the process <code>nc.openbsd</code> (which is netcat) with <code>process_name</code> of <code>/usr/bin/nc.openbsd</code> and <code>process_id</code> of <code>6791</code>.</p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>/usr/bin/nc.openbsd</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 7:
oh. This documentation exercise just turned into an investigation. Starting with the process identified in the previous task, look for additional suspicious commands launched by the same parent process. One thing to know about these Sysmon events is that Network connection events don't indicate the parent process ID, but Process creation events do! Determine the number of files that were accessed by a related process and record it here.</p>
<p>Search the Sysmon logs for the process id 6791, which found in task 6:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">ProcessId</span> <span class="o">=</span> <span class="mi">6791</span>
</code></pre></div>
<p>From the above results you see the <code>ParentProcessId</code> is <code>6788</code>.</p>
<p>Search for the parent process using the following search:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>    <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">ParentProcessId</span><span class="o">=</span><span class="mi">6788</span>
</code></pre></div>
<p>You will see the following process in the result:</p>
<p><img alt="Obj" src="../../../images/obj/9/image4.png" /></p>
<p>The above result shows 6 files.</p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>6</p>
</div>
</div>
<div class="tabbed-block">
<p>Task 8:
Use Splunk and Sysmon Process creation data to identify the name of the Bash script that accessed sensitive files and (likely) transmitted them to a remote IP address.</p>
<p>Search for the <code>process_id</code> of <code>6788</code> from Task 7 using the following search:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>  <span class="n">index</span><span class="o">=</span><span class="n">main</span> <span class="n">sourcetype</span><span class="o">=</span><span class="n">journald</span> <span class="n">source</span><span class="o">=</span><span class="n">Journald</span><span class="p">:</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span> <span class="n">EventCode</span><span class="o">=</span><span class="mi">1</span> <span class="n">process_id</span><span class="o">=</span><span class="mi">6788</span>
</code></pre></div>
<p>The result will show the ParentCommandLine is <code>/bin/bash preinstall.sh</code></p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>preinstall.sh</p>
</div>
</div>
</div>
</div>
</div>
<hr />
<p>Once you solve task 8 you see the following message:</p>
<p><img alt="Obj" src="../../../images/obj/9/image5.png" /></p>
<div class="admonition success">
<p class="admonition-title">Final Answer</p>
<p>whiz</p>
</div>
</div>
</div>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Objective8/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 8) Kerberoasting on an Open Fire" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              8) Kerberoasting on an Open Fire
            </div>
          </div>
        </a>
      
      
        
        <a href="../Objective10/" class="md-footer__link md-footer__link--next" aria-label="Next: 10) Now Hiring!" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              10) Now Hiring!
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "content.tabs.link"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>